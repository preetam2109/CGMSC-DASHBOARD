<div class="columns justify-content-center mb-3">
    <div class="col-12 col-md-6 mb-3">
    <label class="form-label"><strong>Choose Item</strong>:</label>
    <ng-select
      [items]="MasIndentitemslist"
      bindLabel="nameText"
      bindValue="itemid"
      [(ngModel)]="itemid"
      name="itemid"
      (change)="onISelectChange($event)"
      #emailidField="ngModel"
      [placeholder]="!itemid ? 'Choose Item' : ''"
      [searchable]="true"
      [clearable]="true"
      [appendTo]="'body'"
      required
      class="form-control"
    >
    </ng-select>
    </div>

    <div class="col-12 col-md-6 mb-3">
    <label class="form-label"><strong>Choose District</strong>:</label>

        <ng-select
        [items]="districts"
        bindLabel="distname"
        bindValue="districtid"
        [(ngModel)]="districtid"
        name="districtid"
        (change)="onDistrictChange($event)"
        #emailidField="ngModel"
        [placeholder]="!districtid ? 'Choose District' : ''"
        [searchable]="true"
        [clearable]="true"
        [appendTo]="'body'"
        required
        class="form-control"
      >
    </ng-select>
    </div>
    <div class="col-12 col-md-6 mb-3">
    <label class="form-label"><strong>Choose Facility</strong>:</label>

        <ng-select
        [items]="MasfacilityInfolist"
        bindLabel="facilityname"
        bindValue="facilityid"
        [(ngModel)]="facilityid"
        name="facilityid"
        (change)="onFacChange($event)"
        #emailidField="ngModel"
        [placeholder]="!facilityid ? 'Choose Facility' : ''"
        [searchable]="true"
        [clearable]="true"
        [appendTo]="'body'"
        required
        class="form-control"
      >
    </ng-select>
    </div>
<div class="col-12 text-center mb-2">
  <button class="btn btn-primary  w-md-auto" (click)="show()">Show Details</button>
</div>


</div>


<div class="container-fluid p-2" *ngFor="let detail of MasItemlist" >
    <div class="card shadow">
        <div class="card-body">
            <div class="row border mb-1">
                <div class="col-12 text-center font-weight-bold  py-1  text-white " style="background-color: #FF4500;">
                    <strong>Item Info</strong>

                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Code:</strong>
                    <span class="ml-2">{{detail.itemcode}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Name:</strong>
                    <span class="ml-2">{{detail.itemname}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Strength:</strong>
                    <span class="ml-2">{{detail.strengtH1}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>unit(SKU):</strong>
                    <span class="ml-2">{{detail.unit}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Group:</strong>
                    <span class="ml-2">{{detail.groupname}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Type:</strong>
                    <span class="ml-2">{{detail.itemtypename}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong> Category :</strong>
                    <span class="ml-2">{{detail.edl}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong> EDL :</strong>
                    <span class="ml-2">{{detail.edltype}}</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid p-2" *ngFor="let detail of ItemDetailslist" >
    <div class="card shadow">
        <div class="card-body">
            <div class="row border mb-1">
                <div class="col-12 text-center font-weight-bold  py-1  text-white " style="background-color: #0baff0;">
                    <strong>DHS Annual Indent Vs Supply/PO Summary</strong>

                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Annual Indent:</strong>
                    <span class="ml-2">{{detail.dhsai}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Supplied CFY:</strong>
                    <span class="ml-2">{{detail.dhsissue}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>PO CFY:</strong>
                    <span class="ml-2">{{detail.dhspoqty}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Received QTY:</strong>
                    <span class="ml-2">{{detail.dhsrqty}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>CGMSC Ready Stock:</strong>
                    <span class="ml-2">{{detail.readystock}}</span>
                    ,
        
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>CGMSC UQC Stock:</strong>
                    <span class="ml-2">{{detail.qcstock}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>CGMSC Pipeline:</strong>
                    <span class="ml-2">{{detail.totalpiplie}}</span>
                </div>
         
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong> RC Status :</strong>
                    <span class="ml-2">{{detail.rcstatus}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong> RC Rate(SKU):</strong>
                    <span class="ml-2">{{detail.rcrate}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong> RC Start DT :</strong>
                    <span class="ml-2">{{detail.rcstartdt}}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong> RC End DT :</strong>
                    <span class="ml-2">{{detail.rcenddt}}</span>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- DHS Stock -->
<div class="container-fluid p-2" *ngIf="itemid && !districtid && !facilityid">
    <div class="card shadow" *ngFor="let detail of DhsDmeList">
        <div class="card-body">
            <div class="row border mb-1">
                <div class="col-12 text-center font-weight-bold py-1 text-white" style="background-color: #96ec15;">
                    <strong>DHS Stock</strong>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Current Stock (in NOS):</strong>
                    <span class="ml-2">{{ detail.fieldstock }}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Current Stock (in SKU):</strong>
                    <span class="ml-2">{{ detail.fieldstocksku }}</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- District Stock -->
<div class="container-fluid p-2" *ngIf="itemid && districtid && facilityid === 0">
    <div class="card shadow" *ngFor="let detail of DhsDmeList">
        <div class="card-body">
            <div class="row border mb-1">
                <div class="col-12 text-center font-weight-bold py-1 text-white" style="background-color: #fa9f02;">
                    <strong>District Stock ({{distname}} District Stock)</strong>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Current Stock (in NOS):</strong>
                    <span class="ml-2">{{ detail.fieldstock }}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Current Stock (in SKU):</strong>
                    <span class="ml-2">{{ detail.fieldstocksku }}</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Health Facility Stock -->
<div class="container-fluid p-2" *ngIf="itemid && districtid && facilityid">
    <div class="card shadow" *ngFor="let detail of DhsDmeList">
        <div class="card-body">
            <div class="row border mb-1">
                <div class="col-12 text-center font-weight-bold py-1 text-white" style="background-color: #fa9f02;">
                    <strong>Health Facility Stock ({{facilityname}} Stock)</strong>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Current Stock (in NOS):</strong>
                    <span class="ml-2">{{ detail.fieldstock }}</span>
                </div>
                <div class="col-12 col-md-4 border p-2 d-flex">
                    <strong>Current Stock (in SKU):</strong>
                    <span class="ml-2">{{ detail.fieldstocksku }}</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid p-2" *ngIf="itemid && districtid && facilityid === 0" >
<div class="card shadow" >
    <div class="card-body">
        <div class="row border mb-1">
            <div class="col-12 text-center font-weight-bold py-1 text-white" style="background-color:#8ac926;">
                <strong>Facility-wise Stock vs Supply/Consumption</strong>
            </div>
        </div>
        <div class="col-lg-12 col-md-12 table-container mb-4">
     
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div class="filter-field flex-grow-1">
                <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilter($event)">
              </div>
              <div class="export-menu-container">
                <button mat-button [matMenuTriggerFor]="exportMenu">Export</button>
                <mat-menu #exportMenu="matMenu">
                  <button mat-menu-item
                    (click)="exporter.exportTable('xlsx', { fileName: 'supplierWise', sheet: 'supplierWise', Props: { Author: 'cgmsc' }})">Excel</button>
                  <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
                  <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
                  <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
                  <button mat-button (click)="exportToPDF()">PDF</button>
      
                </mat-menu>
              </div>
            </div>
      
            <div class="table-responsive">
              <table class="table table-bordered table-striped" mat-table matTableExporter [dataSource]="dataSource" #exporter="matTableExporter" matSort>
      
                       <!-- Serial Number Column -->
                <ng-container matColumnDef="sno">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
                  <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
                </ng-container>
      
                    <ng-container matColumnDef="facilityname">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Facility Name</th>
                      <td mat-cell *matCellDef="let element"> {{ element.facilityname }} </td>
                    </ng-container>
      
                    <ng-container matColumnDef="totalstock">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Current Stock</th>
                      <td mat-cell *matCellDef="let element"> {{ element.totalstock }} </td>
                    </ng-container>
      
                    <ng-container matColumnDef="whissued">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Supplied By Warehouse (CFY)</th>
                      <td mat-cell *matCellDef="let element"> {{ element.whissued }} </td>
                    </ng-container>
                    <ng-container matColumnDef="consumption">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Consumption (CFY)</th>
                      <td mat-cell *matCellDef="let element"> {{ element.consumption }} </td>
                    </ng-container>
               
                  
                <!-- Header Row -->
                <tr mat-header-row *matHeaderRowDef="['sno','facilityname','totalstock','whissued','consumption']"></tr>
      
                <!-- Data Rows -->
                <tr mat-row *matRowDef="let row; columns: ['sno','facilityname','totalstock','whissued','consumption'];"></tr>
      
              </table>
            </div>      
            <mat-paginator [pageSizeOptions]="[10, 15, 30]" showFirstLastButtons></mat-paginator>
          </div>
    </div>
</div>
    

  </div>
