<div class="card shadow">
  <div class="card-body">

    <!--Scheme-Wise Work Abstract -->
    <div class="card shadow mb-3 mt-0 pt-0">
      <div class="card-body">
        <div class="w-100 m-0 p-0 rounded bg-dark" style="font-size: large;">
          <h3 class="bold text-light text-align text-center">Scheme-Wise Work Abstract</h3>
        </div>

        <!-- <div class="container-fluid">
        
        <mat-tab-group (selectedTabChange)="selectedTabValue($event)" (click)="DashProgressCount()">
        <mat-tab-group (selectedTabChange)="selectedTabValue($event)">
          <mat-tab label="Total Works">
            <ng-template matTabContent>
              <div class="container-fluid mt-4">
                <div class="container-fluid p-2">
                  <div class="row ">
  
                      <div class="col-12 col-md-6 mb-3">
                        <div class="columns justify-content-center mb-3">
                          <ng-select [items]="mainscheme" bindLabel="name" bindValue="mainSchemeID" [(ngModel)]="mainSchemeID"
                            name="mainSchemeID" (change)="onselect_mainscheme_data($event)" #emailidField="ngModel"
                            [placeholder]="!mainSchemeID ? 'Select Scheme : ' : ''" [searchable]="true" [clearable]="true" [appendTo]="'body'"
                            required class="form-control">
                          </ng-select>
                        </div>
                      </div>
                      <div class="col-12 col-md-6 mb-3">
                        <div class="columns justify-content-center mb-3">
                          <ng-select [items]="budgetOptions" bindLabel="label" bindValue="buid" [(ngModel)]="buid"
                            name="buid" (change)="onselect_databudgetOptions($event)" #nameidField="ngModel"
                            [placeholder]="!buid ? 'Select value : ' : ''" [searchable]="true" [clearable]="true" [appendTo]="'body'"
                            required class="form-control">
                          </ng-select>
                        </div>
                      </div>
                     
                  </div>
                </div>
  
  
              </div>
            </ng-template>
          </mat-tab>
  
          <mat-tab label="Division-wise" *ngIf="showDivision">
            <ng-template matTabContent>
              <div class="card-division">
                <div class="row ">
                  <div class="col-12 col-md-3 mt-3">
                    <div class="columns justify-content-center mb-3">
                      <ng-select [items]="mainscheme" bindLabel="name" bindValue="mainSchemeID" [(ngModel)]="mainSchemeID"
                        name="mainSchemeID" (change)="onselect_mainscheme_data($event)" #emailidField="ngModel"
                        [placeholder]="!mainSchemeID ? 'Select Scheme : ' : ''" [searchable]="true" [clearable]="true" [appendTo]="'body'"
                        required class="form-control">
                      </ng-select>
                    </div>
                  </div>
                  
                  <div class="col-12 col-md-9  p-2 ">
                    <div class="button-container">
                      <label class="division-label align-items-center  pt-2"> Choose Division: </label>
                      <button class="btn btn-sm align-items-center" style="background-color: #D3D3D3;"
                        *ngFor="let division of divisions" [ngClass]="{'active-button': selectedDistrict === division.id}"
                        (click)="onButtonClick(division.name, division.id)">
                        {{ division.name }}
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <label class="division-label" *ngIf="hide">Selected Scheme: {{ selectedName }}</label>&nbsp;
              <label class="division-label" *ngIf="show">{{ name }}Division</label>
  
            </ng-template>
          </mat-tab>
  
          <mat-tab label="District-wise" *ngIf="showDistrict">
            <ng-template matTabContent>
              <div class="card-division">
                <div class="row ">
                 
                      <div class="col-12 col-md-6 mt-3">
                        <div class="columns justify-content-center mb-3">
                          <ng-select [items]="mainscheme" bindLabel="name" bindValue="mainSchemeID" [(ngModel)]="mainSchemeID"
                            name="mainSchemeID" (change)="onselect_mainscheme_data($event)" #emailidField="ngModel"
                            [placeholder]="!mainSchemeID ? 'Select Scheme' : ''" [searchable]="true" [clearable]="true" [appendTo]="'body'"
                            required class="form-control">
                          </ng-select>
                        </div>
                      </div>
                      <div class="col-12 col-md-6 mt-3">
                        <div class="columns justify-content-center mb-3">
                          <ng-select [items]="GetDistrict" bindLabel="districtname" bindValue="districT_ID" [(ngModel)]="districT_ID"
                            name="districT_ID" (change)="onGetDistrictsSelect($event,0)" #emailidField="ngModel"
                            [placeholder]="!districT_ID ? 'Select District' : ''" [searchable]="true" [clearable]="true" [appendTo]="'body'"
                            required class="form-control">
                          </ng-select>
                        </div>
                      </div>
                </div>
              </div>
              <label class="division-label" *ngIf="hide">Selected Scheme: {{ selectedName }}</label>&nbsp;
              <label class="division-label" *ngIf="show">{{ distname }}</label>
            </ng-template>
          </mat-tab>
  
          <mat-tab label="District-wise">
        <ng-template matTabContent>
          <div class="card-division">
          <div class="dropdown-container">
            <div class="row ">
              <div class="col-12 col-md-6  p-2 ">
                <mat-form-field appearance="fill" class="dropdown-field">
                  <mat-label>Select Districts</mat-label>
                  <mat-select (selectionChange)="onGetDistrictsSelect($event.value)">
                    <mat-option *ngFor="let districts of GetDistrict" [value]="districts.districT_ID">
                      {{ districts.districtname }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-12 col-md-6  p-2 ">
                <mat-form-field appearance="fill" class="dropdown-field">
                  <mat-label>Select Main Scheme</mat-label>
                  <mat-select (selectionChange)="onselect_mainscheme_data($event.value)">
                    <mat-option *ngFor="let mainscheme of mainscheme" [value]="mainscheme.mainSchemeID">
                      {{ mainscheme.name }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
            </div>
          </div>
          </div>
        </ng-template>
      </mat-tab>
  
          <mat-tab label="MedicalCollege-wise">
            <ng-template matTabContent>
              <div class="card-division">
                <div class="row ">
                  <div class="col-12 col-md-6 mt-3">
                    <div class="columns justify-content-center mb-3">
                      <ng-select [items]="DistrictNameDMEData" bindLabel="districtname" bindValue="districT_ID" [(ngModel)]="districT_ID"
                        name="districT_ID" (change)="onselectDistrictsDME($event,0)" #emailidField="ngModel"
                        [placeholder]="!districT_ID ? 'Select District' : ''" [searchable]="true" [clearable]="true" [appendTo]="'body'"
                        required class="form-control">
                      </ng-select>
                    </div>
                  </div>
  
  
  
                 
  
                </div>
                <div class="container-fluid p-4" *ngIf="showCardss">
                  <div class="row">
                    <div class="col-lg-6 col-md-12 mb-4" >
                      <div class="chart-container">
                        <apx-chart *ngIf="chartOptions.series.length > 0"  [series]="chartOptions.series" [chart]="chartOptions.chart"
                          [dataLabels]="chartOptions.dataLabels" [plotOptions]="chartOptions.plotOptions"
                          [xaxis]="chartOptions.xaxis" [stroke]="chartOptions.stroke" [fill]="chartOptions.fill"
                          [yaxis]="chartOptions.yaxis" [title]="chartOptions.title" [tooltip]="chartOptions.tooltip"
                          [legend]="chartOptions.legend"></apx-chart>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
  
            </ng-template>
          </mat-tab>
  
        
        </mat-tab-group>
  
      </div> -->

        <div class="container-fluid mt-4">
          <div class="container-fluid p-2">
            <div class="row ">
              <div class="col-12 col-md-6 mb-3">
                <div class="columns justify-content-center mb-3">
                  <ng-select [items]="mainscheme" bindLabel="name" bindValue="mainSchemeID" [(ngModel)]="mainSchemeID"
                    name="mainSchemeID" (change)="onselect_mainscheme_data($event)" #emailidField="ngModel"
                    [placeholder]="!mainSchemeID ? 'Select Scheme : ' : ''" [searchable]="true" [clearable]="true"
                    [appendTo]="'body'" required class="form-control">
                  </ng-select>
                </div>
              </div>
              <div class="col-12 col-md-6 mb-3">
                <div class="columns justify-content-center mb-3">
                  <ng-select [items]="budgetOptions" bindLabel="label" bindValue="buid" [(ngModel)]="buid" name="buid"
                    (change)="onselect_databudgetOptions($event)" #nameidField="ngModel"
                    [placeholder]="!buid ? 'Select value : ' : ''" [searchable]="true" [clearable]="true"
                    [appendTo]="'body'" required class="form-control">
                  </ng-select>
                </div>
              </div>

            </div>
          </div>
        </div>
        <div class="container-fluid mt-4" *ngIf="showCards">
          <div class="row">
            <!-- <div class="row"> -->
            <!-- Static Card for Total Works -->
            <!-- <div class="col-lg-3 col-md-6 col-sm-12 mb-4" *ngIf="totalNosWorks != 0 "> -->
            <div class="col-lg-3 col-md-6 col-sm-12 mb-4">
              <a type="link" (click)="TotalWorksAbstract()">
                <mat-card class="card-class text-center" style="background-color: #6a6afd; color: Black;">
                  <mat-card-header class="mat-card-header" style="border-bottom: none; text-align: center;">
                    <mat-icon role="img" mat-card-avatar
                      class="mat-icon notranslate mat-card-avatar material-icons mat-icon-no-color"
                      style="font-size: 40px; color: white;" aria-hidden="true">
                      account_balance
                    </mat-icon>
                    <div style="text-align: center; margin-top: -20px; margin-left: 5%;">
                      <h5 style="font-size: 18px; font-weight: bold;">Total Works</h5>
                    </div>
                  </mat-card-header>
                  <mat-card-content>
                    <h3 class="font-weight-bold" style="font-weight: bold; font-size: 16px;">
                      {{ totalNosWorks }}
                    </h3>
                  </mat-card-content>
                </mat-card>
              </a>
            </div>

            <!-- Dynamic Cards for Other District Data -->
            <div class="col-lg-3 col-md-6 col-sm-12 mb-4" *ngFor="let district of districtData">
              <a type="link" (click)="DetailProgress(district.did,district.dashname,district.nosworks)">
                <!-- <a type="link" (click)="open_mobile_modal(1,itemDetailsModal)"> DetailProgress-->
                <!-- <a type="link"> -->
                <mat-card class="card-class text-center"
                  [ngStyle]="{'background-color': getCardColor(district.did), 'color': 'Black'}">
                  <mat-card-header class="mat-card-header" style="border-bottom: none; text-align: center;">
                    <mat-icon role="img" mat-card-avatar
                      class="mat-icon notranslate mat-card-avatar material-icons mat-icon-no-color"
                      style="font-size: 40px; color: white;" aria-hidden="true">
                      {{ getIcon(district.did) }}
                    </mat-icon>
                    <div style="text-align: center; margin-top: -20px; margin-left: 5%;">
                      <h5 style="font-size: 18px; font-weight: bold;">{{ district.dashname }}</h5>
                    </div>
                  </mat-card-header>
                  <mat-card-content>
                    <h3 class="font-weight-bold" style="font-weight: bold; font-size: 16px;">
                      {{ district.nosworks }}
                    </h3>
                  </mat-card-content>
                </mat-card>
                <!-- </a> -->
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--Land Issued-->
    <div class="card shadow mb-3" *ngIf="visibale">
      <div class="card-body">
        <div class="w-100 mt-1 pb-2 rounded">
          <h3 class="bold text-light bg-dark" style="font-size: large;">Land Issue</h3>
        </div>
        <div class="container-fluid p-1">
          <div class="row" *ngIf="LIPendingTotalData.length > 0;else other_content">
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="LIPendingTotalData.length > 0">
              <div class="chart-container">

                <apx-chart [series]="chartOptionsLITotal.series" [chart]="chartOptionsLITotal.chart"
                  [dataLabels]="chartOptionsLITotal.dataLabels" [plotOptions]="chartOptionsLITotal.plotOptions"
                  [xaxis]="chartOptionsLITotal.xaxis" [stroke]="chartOptionsLITotal.stroke"
                  [fill]="chartOptionsLITotal.fill" [yaxis]="chartOptionsLITotal.yaxis"
                  [title]="chartOptionsLITotal.title" [tooltip]="chartOptionsLITotal.tooltip"
                  [legend]="chartOptionsLITotal.legend"></apx-chart>
              </div>
            </div>
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="LIPendingSchemeData.length > 0">
              <div class="chart-container">
                <apx-chart [series]="chartOptionsLIScheme.series" [chart]="chartOptionsLIScheme.chart"
                  [dataLabels]="chartOptionsLIScheme.dataLabels" [plotOptions]="chartOptionsLIScheme.plotOptions"
                  [xaxis]="chartOptionsLIScheme.xaxis" [stroke]="chartOptionsLIScheme.stroke"
                  [fill]="chartOptionsLIScheme.fill" [yaxis]="chartOptionsLIScheme.yaxis"
                  [title]="chartOptionsLIScheme.title" [tooltip]="chartOptionsLIScheme.tooltip"
                  [legend]="chartOptionsLIScheme.legend"></apx-chart>
              </div>
            </div>
          </div>
          <ng-template class="row" #other_content>
            <strong style="font-size: 20px;">No Land Issued are currently available for the scheme.</strong>
          </ng-template>
        </div>
      </div>
    </div>
    <!-- Running Works summary -->
    <div class="card shadow mb-3" *ngIf="visibale">
      <div class="card-body">
        <div class="w-100 mt-1 pb-2 rounded">
          <!-- #e2e3e5 -->
          <h3 class="bold text-light bg-dark" style="font-size: large;">Running Works Summary</h3>
        </div>
        <!-- <div class="card-body pt-0"> -->
        <div class="container-fluid  p-1">
          <div class="row" *ngIf="RunningWorkDataScheme.length > 0;else other_content">
            <!-- <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="RunningWorkDataGTotal.length > 0"> -->
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="RunningWorkDataScheme.length > 0">
              <div class="chart-container">
                <apx-chart [series]="chartOptions.series" [chart]="chartOptions.chart"
                  [dataLabels]="chartOptions.dataLabels" [plotOptions]="chartOptions.plotOptions"
                  [xaxis]="chartOptions.xaxis" [stroke]="chartOptions.stroke" [fill]="chartOptions.fill"
                  [yaxis]="chartOptions.yaxis" [title]="chartOptions.title" [tooltip]="chartOptions.tooltip"
                  [legend]="chartOptions.legend"></apx-chart>
              </div>
            </div>
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="RunningWorkDataDivision.length > 0">
              <div class="chart-container">
                <apx-chart [series]="chartOptions1.series" [chart]="chartOptions1.chart"
                  [dataLabels]="chartOptions1.dataLabels" [plotOptions]="chartOptions1.plotOptions"
                  [xaxis]="chartOptions1.xaxis" [stroke]="chartOptions1.stroke" [fill]="chartOptions1.fill"
                  [yaxis]="chartOptions1.yaxis" [title]="chartOptions1.title" [tooltip]="chartOptions1.tooltip"
                  [legend]="chartOptions1.legend"></apx-chart>
              </div>
            </div>
          </div>
          <ng-template class="row" #other_content>
            <strong style="font-size: 20px;">No Running Works are currently available for the scheme.</strong>
          </ng-template>
          <!-- <div class="row"> -->
          <!-- <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="RunningWorkDataScheme.length > 0">
                                    <div class="chart-container">
                                        <apx-chart [series]="chartOptions2.series" [chart]="chartOptions2.chart"
                                            [dataLabels]="chartOptions2.dataLabels" [plotOptions]="chartOptions2.plotOptions"
                                            [xaxis]="chartOptions2.xaxis" [stroke]="chartOptions2.stroke"
                                            [fill]="chartOptions2.fill" [yaxis]="chartOptions2.yaxis"
                                            [title]="chartOptions2.title" [tooltip]="chartOptions2.tooltip"
                                            [legend]="chartOptions2.legend"></apx-chart>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="RunningWorkDataDistrict.length > 0">
                                    <div class="chart-container">
                                        <apx-chart [series]="chartOptions3.series" [chart]="chartOptions3.chart"
                                            [dataLabels]="chartOptions3.dataLabels" [plotOptions]="chartOptions3.plotOptions"
                                            [xaxis]="chartOptions3.xaxis" [stroke]="chartOptions3.stroke"
                                            [fill]="chartOptions3.fill" [yaxis]="chartOptions3.yaxis"
                                            [title]="chartOptions3.title" [tooltip]="chartOptions3.tooltip"
                                            [legend]="chartOptions3.legend"></apx-chart>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="RunningWorkDataContractor.length > 0">
                                    <div class="chart-container">
                                        <apx-chart [series]="chartOptions4.series" [chart]="chartOptions4.chart"
                                            [dataLabels]="chartOptions4.dataLabels" [plotOptions]="chartOptions4.plotOptions"
                                            [xaxis]="chartOptions4.xaxis" [stroke]="chartOptions4.stroke"
                                            [fill]="chartOptions4.fill" [yaxis]="chartOptions4.yaxis"
                                            [title]="chartOptions4.title" [tooltip]="chartOptions4.tooltip"
                                            [legend]="chartOptions4.legend"></apx-chart>
                                    </div>
                                </div> -->
          <!-- </div> -->
        </div>
        <!-- </div> -->
      </div>
    </div>
    <!-- Live Tender -->
    <div class="card shadow mb-3" *ngIf="visibale">
      <div class="card-body">
        <!-- <div class="w-100 mt-2" style="background-color:#050382;font-size: large;">
              <h3 class="bold text-light">Live Tender </h3>
            </div> -->
        <div class="w-100 mt-1 pb-2 rounded">
          <h3 class="bold text-light bg-info" style="font-size: large;">Live Tender Summary</h3>
        </div>
        <div class="container-fluid  p-1">
          <div class="row" *ngIf="LiveTenderScheme.length > 0;else other_content">
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="LiveTenderScheme.length > 0">
              <div class="chart-container">
                <apx-chart [series]="chartliveTenderTO.series" [chart]="chartliveTenderTO.chart"
                  [dataLabels]="chartliveTenderTO.dataLabels" [plotOptions]="chartliveTenderTO.plotOptions"
                  [xaxis]="chartliveTenderTO.xaxis" [stroke]="chartliveTenderTO.stroke" [fill]="chartliveTenderTO.fill"
                  [yaxis]="chartliveTenderTO.yaxis" [title]="chartliveTenderTO.title"
                  [tooltip]="chartliveTenderTO.tooltip" [legend]="chartliveTenderTO.legend"></apx-chart>
              </div>
            </div>
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="LiveTenderDivision.length > 0">
              <div class="chart-container">

                <apx-chart [series]="chartliveTenderDiv.series" [chart]="chartliveTenderDiv.chart"
                  [dataLabels]="chartliveTenderDiv.dataLabels" [plotOptions]="chartliveTenderDiv.plotOptions"
                  [xaxis]="chartliveTenderDiv.xaxis" [stroke]="chartliveTenderDiv.stroke"
                  [fill]="chartliveTenderDiv.fill" [yaxis]="chartliveTenderDiv.yaxis" [title]="chartliveTenderDiv.title"
                  [tooltip]="chartliveTenderDiv.tooltip" [legend]="chartliveTenderDiv.legend"></apx-chart>
              </div>
            </div>
          </div>
          <ng-template class="row" #other_content>
            <strong style="font-size: 20px;">No live tenders are currently available for the scheme.</strong>
          </ng-template>
        </div>
      </div>
    </div>
    <!-- To be Tender -->
    <div class="card shadow mb-3" *ngIf="visibale">
      <div class="card-body">
        <div class="w-100 mt-1 pb-2 rounded">
          <h3 class="bold text-light bg-success" style="font-size: large;">To be Tender Summary</h3>
        </div>
        <div class="container-fluid  p-1">
          <div class="row" *ngIf="TobetenderGTotal.length > 0;else other_content">
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="TobetenderGTotal.length > 0">
              <div class="chart-container">
                <apx-chart [series]="chartOptionsTbetender.series" [chart]="chartOptionsTbetender.chart"
                  [dataLabels]="chartOptionsTbetender.dataLabels" [plotOptions]="chartOptionsTbetender.plotOptions"
                  [xaxis]="chartOptionsTbetender.xaxis" [stroke]="chartOptionsTbetender.stroke"
                  [fill]="chartOptionsTbetender.fill" [yaxis]="chartOptionsTbetender.yaxis"
                  [title]="chartOptionsTbetender.title" [tooltip]="chartOptionsTbetender.tooltip"
                  [legend]="chartOptionsTbetender.legend"></apx-chart>


              </div>
            </div>
            <!-- <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="LiveTenderDivision.length > 0">
                  <div class="chart-container">
        
                    <apx-chart [series]="chartliveTenderDiv.series" [chart]="chartliveTenderDiv.chart"
                      [dataLabels]="chartliveTenderDiv.dataLabels" [plotOptions]="chartliveTenderDiv.plotOptions"
                      [xaxis]="chartliveTenderDiv.xaxis" [stroke]="chartliveTenderDiv.stroke" [fill]="chartliveTenderDiv.fill"
                      [yaxis]="chartliveTenderDiv.yaxis" [title]="chartliveTenderDiv.title"
                      [tooltip]="chartliveTenderDiv.tooltip" [legend]="chartliveTenderDiv.legend"></apx-chart>
                  </div>
                </div> -->
          </div>
          <ng-template class="row" #other_content>
            <strong style="font-size: 20px;">No Tender are currently available for the scheme.</strong>
          </ng-template>
        </div>
      </div>
    </div>

    <!--Tender Evaluation-->
    <div class="card shadow mb-3" *ngIf="visibale">
      <div class="card-body">
        <div class="w-100 mt-1 pb-2 rounded">
          <h3 class="bold text-light bg-dark" style="font-size: large;">Technical Evaluation</h3>
        </div>
        <div class="container-fluid  p-1">
          <div class="row" *ngIf="TenderEvaluationScheme.length > 0;else other_content">
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="TenderEvaluationScheme.length > 0">
              <div class="chart-container">
                <apx-chart [series]="chartOptionsTEScheme.series" [chart]="chartOptionsTEScheme.chart"
                  [dataLabels]="chartOptionsTEScheme.dataLabels" [plotOptions]="chartOptionsTEScheme.plotOptions"
                  [xaxis]="chartOptionsTEScheme.xaxis" [stroke]="chartOptionsTEScheme.stroke"
                  [fill]="chartOptionsTEScheme.fill" [yaxis]="chartOptionsTEScheme.yaxis"
                  [title]="chartOptionsTEScheme.title" [tooltip]="chartOptionsTEScheme.tooltip"
                  [legend]="chartOptionsTEScheme.legend"></apx-chart>


              </div>
            </div>
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="TenderEvaluationDivision.length > 0">
              <div class="chart-container">

                <apx-chart [series]="chartOptionsTESDivision.series" [chart]="chartOptionsTESDivision.chart"
                  [dataLabels]="chartOptionsTESDivision.dataLabels" [plotOptions]="chartOptionsTESDivision.plotOptions"
                  [xaxis]="chartOptionsTESDivision.xaxis" [stroke]="chartOptionsTESDivision.stroke"
                  [fill]="chartOptionsTESDivision.fill" [yaxis]="chartOptionsTESDivision.yaxis"
                  [title]="chartOptionsTESDivision.title" [tooltip]="chartOptionsTESDivision.tooltip"
                  [legend]="chartOptionsTESDivision.legend"></apx-chart>
              </div>
            </div>
          </div>
          <ng-template class="row" #other_content>
            <strong style="font-size: 20px;">No Tender are currently available for the scheme.</strong>
          </ng-template>
        </div>
      </div>
    </div>
    <!--Work Order Pending-->
    <div class="card shadow mb-3" *ngIf="visibale">
      <div class="card-body">
        <div class="w-100 mt-1 pb-2 rounded">
          <h3 class="bold text-light bg-dark" style="font-size: large;">Work Order</h3>
        </div>
        <div class="container-fluid  p-1">
          <div class="row">
            <div class="card-body row mt-0 pt-0 pl-0" style="padding-right:0%;">
              <div class=" border rounded custom-form-field">
                <mat-form-field class="filter-field w-100 " appearance="fill">
                  <mat-label>Date Range</mat-label>
                  <mat-date-range-input [rangePicker]="picker3" [formGroup]="dateRange2">
                    <input matStartDate placeholder="Start date" formControlName="start" class="custom-inputt">
                    <input matEndDate placeholder="End date" formControlName="end" class="custom-inputt">
                  </mat-date-range-input>
                  <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                  <mat-date-range-picker #picker3></mat-date-range-picker>
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="row" *ngIf="WoIssuedTotal.length > 0;else other_content">

            <!-- <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="wOpendingScheme.length > 0">
                    <div class="chart-container">
                      <apx-chart [series]="chartOptionsWOPScheme.series" [chart]="chartOptionsWOPScheme.chart"
                        [dataLabels]="chartOptionsWOPScheme.dataLabels" [plotOptions]="chartOptionsWOPScheme.plotOptions"
                        [xaxis]="chartOptionsWOPScheme.xaxis" [stroke]="chartOptionsWOPScheme.stroke" [fill]="chartOptionsWOPScheme.fill"
                        [yaxis]="chartOptionsWOPScheme.yaxis" [title]="chartOptionsWOPScheme.title" [tooltip]="chartOptionsWOPScheme.tooltip"
                        [legend]="chartOptionsWOPScheme.legend"></apx-chart>
          
          
                    </div>
                  </div> -->
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="wOpendingDivision.length > 0">
              <div class="chart-container">
                <apx-chart [series]="chartOptionsWOPDivision.series" [chart]="chartOptionsWOPDivision.chart"
                  [dataLabels]="chartOptionsWOPDivision.dataLabels" [plotOptions]="chartOptionsWOPDivision.plotOptions"
                  [xaxis]="chartOptionsWOPDivision.xaxis" [stroke]="chartOptionsWOPDivision.stroke"
                  [fill]="chartOptionsWOPDivision.fill" [yaxis]="chartOptionsWOPDivision.yaxis"
                  [title]="chartOptionsWOPDivision.title" [tooltip]="chartOptionsWOPDivision.tooltip"
                  [legend]="chartOptionsWOPDivision.legend"></apx-chart>
              </div>
            </div>
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="WoIssuedTotal.length > 0">
              <div class="chart-container">
                <span class="bold mt-1" style="color: rgb(110, 13, 37);">Duration: {{fromdt3}} To {{todt3}}</span>
                <apx-chart [series]="chartOptionsWOI.series" [chart]="chartOptionsWOI.chart"
                  [dataLabels]="chartOptionsWOI.dataLabels" [plotOptions]="chartOptionsWOI.plotOptions"
                  [xaxis]="chartOptionsWOI.xaxis" [stroke]="chartOptionsWOI.stroke" [fill]="chartOptionsWOI.fill"
                  [yaxis]="chartOptionsWOI.yaxis" [title]="chartOptionsWOI.title" [tooltip]="chartOptionsWOI.tooltip"
                  [legend]="chartOptionsWOI.legend"></apx-chart>
              </div>
            </div>
          </div>
          <ng-template class="row" #other_content>
            <strong style="font-size: 20px;">No Work Order are currently available for the scheme.</strong>
          </ng-template>
        </div>

      </div>
    </div>
    <!-- Handover Works -->
    <div class="card shadow mb-3" *ngIf="visibale">
      <div class="card-body">
        <div class="w-100"> <!--#e2e3e5 style="background-color:#858681"-->
          <h3 class="bold text-light bg-dark">Handover Works Summary</h3>
        </div>
        <div class="container-fluid  p-1 mt-0">
          <div class="row">
            <div class="card-body row mt-0 pt-0 pl-0" style="padding-right:0%;">
              <div class=" border rounded custom-form-field">
                <mat-form-field class="filter-field w-100 " appearance="fill">
                  <mat-label>Date Range</mat-label>
                  <mat-date-range-input [rangePicker]="picker" [formGroup]="dateRange">
                    <input matStartDate placeholder="Start date" formControlName="start" class="custom-inputt">
                    <input matEndDate placeholder="End date" formControlName="end" class="custom-inputt">
                  </mat-date-range-input>
                  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-date-range-picker #picker></mat-date-range-picker>
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="row" *ngIf="HandoverAbstractSchemeData.length > 0;else other_content">
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="HandoverAbstractSchemeData.length > 0">
              <div class="chart-container">
                <span class="bold mt-1" style="color: rgb(110, 13, 37);">Duration: {{fromdt}} To
                  {{todt}}</span>
                <apx-chart [series]="chartHandover1.series" [chart]="chartHandover1.chart"
                  [dataLabels]="chartHandover1.dataLabels" [plotOptions]="chartHandover1.plotOptions"
                  [xaxis]="chartHandover1.xaxis" [stroke]="chartHandover1.stroke" [fill]="chartHandover1.fill"
                  [yaxis]="chartHandover1.yaxis" [title]="chartHandover1.title" [tooltip]="chartHandover1.tooltip"
                  [legend]="chartHandover1.legend"></apx-chart>
              </div>
            </div>
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="HandoverAbstractTotalData.length > 0">
              <div class="chart-container">
                <span class="bold mt-1" style="color: rgb(110, 13, 37);">Duration: {{fromdt}} To
                  {{todt}}</span>
                <!-- <span class="bold mt-1">{{fromdt}} To {{todt}}</span> -->
                <apx-chart [series]="chartHandover.series" [chart]="chartHandover.chart"
                  [dataLabels]="chartHandover.dataLabels" [plotOptions]="chartHandover.plotOptions"
                  [xaxis]="chartHandover.xaxis" [stroke]="chartHandover.stroke" [fill]="chartHandover.fill"
                  [yaxis]="chartHandover.yaxis" [title]="chartHandover.title" [tooltip]="chartHandover.tooltip"
                  [legend]="chartHandover.legend"></apx-chart>
              </div>
            </div>

          </div>
          <ng-template class="row" #other_content>
            <strong style="font-size: 20px;">No Handover Work are currently available for the scheme.</strong>
          </ng-template>
          <!-- <div class="row">
                <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="HandoverAbstractDistrictData.length > 0">
                    <div class="chart-container">
                        <span class="bold mt-1" style="color: rgb(110, 13, 37);">Duration: {{fromdt}} To
                            {{todt}}</span>
                        <apx-chart [series]="chartHandover2.series" [chart]="chartHandover2.chart"
                            [dataLabels]="chartHandover2.dataLabels" [plotOptions]="chartHandover2.plotOptions"
                            [xaxis]="chartHandover2.xaxis" [stroke]="chartHandover2.stroke"
                            [fill]="chartHandover2.fill" [yaxis]="chartHandover2.yaxis"
                            [title]="chartHandover2.title" [tooltip]="chartHandover2.tooltip"
                            [legend]="chartHandover2.legend"></apx-chart>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6 mb-2 border rounded"  *ngIf="HandoverAbstractWorkTypeData.length > 0">
                    <div class="chart-container">
                        <span class="bold mt-1" style="color: rgb(110, 13, 37);">Duration: {{fromdt}} To
                            {{todt}}</span>
                        <apx-chart [series]="chartHandover3.series" [chart]="chartHandover3.chart"
                            [dataLabels]="chartHandover3.dataLabels" [plotOptions]="chartHandover3.plotOptions"
                            [xaxis]="chartHandover3.xaxis" [stroke]="chartHandover3.stroke"
                            [fill]="chartHandover3.fill" [yaxis]="chartHandover3.yaxis"
                            [title]="chartHandover3.title" [tooltip]="chartHandover3.tooltip"
                            [legend]="chartHandover3.legend"></apx-chart>
                    </div>
                </div>


            </div> -->
        </div>

      </div>
    </div>
    <!--Payment Due-->
    <div class="card shadow mb-3" *ngIf="visibale">
      <div class="card-body">
        <div class="w-100 mt-1 pb-0">
          <h3 class="bold text-light bg-dark" style="font-size: large;">Payment Due</h3>
        </div>
        <!-- <div class="card shadow"> -->
        <!-- <div class="card-body pt-0 mt-0"> -->
        <div class="container-fluid  p-1 mt-2">
          <div class="row" *ngIf="UnPaidSummaryScheme.length > 0;else other_content">
            <!-- <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="UnPaidSummaryTotal.length > 0"> -->
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="UnPaidSummaryScheme.length > 0">
              <div class="chart-container">
                <apx-chart [series]="chartUnPaid3.series" [chart]="chartUnPaid3.chart"
                  [dataLabels]="chartUnPaid3.dataLabels" [plotOptions]="chartUnPaid3.plotOptions"
                  [xaxis]="chartUnPaid3.xaxis" [stroke]="chartUnPaid3.stroke" [fill]="chartUnPaid3.fill"
                  [yaxis]="chartUnPaid3.yaxis" [title]="chartUnPaid3.title" [tooltip]="chartUnPaid3.tooltip"
                  [legend]="chartUnPaid3.legend"></apx-chart>

              </div>
            </div>
            <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="UnPaidSummaryDivision.length > 0">
              <div class="chart-container">
                <apx-chart [series]="chartUnPaid.series" [chart]="chartUnPaid.chart"
                  [dataLabels]="chartUnPaid.dataLabels" [plotOptions]="chartUnPaid.plotOptions"
                  [xaxis]="chartUnPaid.xaxis" [stroke]="chartUnPaid.stroke" [fill]="chartUnPaid.fill"
                  [yaxis]="chartUnPaid.yaxis" [title]="chartUnPaid.title" [tooltip]="chartUnPaid.tooltip"
                  [legend]="chartUnPaid.legend"></apx-chart>
              </div>
            </div>
          </div>
          <ng-template class="row" #other_content>
            <strong style="font-size: 20px;">No Payment Due are currently available for the scheme.</strong>
          </ng-template>
          <!-- <div class="row">
                      <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="UnPaidSummaryScheme.length > 0">
                          <div class="chart-container">
                              <apx-chart [series]="chartUnPaid1.series" [chart]="chartUnPaid1.chart"
                                  [dataLabels]="chartUnPaid1.dataLabels" [plotOptions]="chartUnPaid1.plotOptions"
                                  [xaxis]="chartUnPaid1.xaxis" [stroke]="chartUnPaid1.stroke" [fill]="chartUnPaid1.fill"
                                  [yaxis]="chartUnPaid1.yaxis" [title]="chartUnPaid1.title" [tooltip]="chartUnPaid1.tooltip"
                                  [legend]="chartUnPaid1.legend"></apx-chart>
                          </div>
                      </div>
                      <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="UnPaidSummaryDesignation.length > 0">
                          <div class="chart-container">
                              <apx-chart [series]="chartUnPaid2.series" [chart]="chartUnPaid2.chart"
                                  [dataLabels]="chartUnPaid2.dataLabels" [plotOptions]="chartUnPaid2.plotOptions"
                                  [xaxis]="chartUnPaid2.xaxis" [stroke]="chartUnPaid2.stroke" [fill]="chartUnPaid2.fill"
                                  [yaxis]="chartUnPaid2.yaxis" [title]="chartUnPaid2.title" [tooltip]="chartUnPaid2.tooltip"
                                  [legend]="chartUnPaid2.legend"></apx-chart>
                          </div>
                      </div>
                  </div> -->
        </div>
        <!-- </div> -->
      </div>
    </div>
    <!-- Payment Done -->
    <div class="card shadow mb-3" *ngIf="visibale">
      <div class="card-body">
        <div class="w-100 mt-1 pb-0">
          <!-- #e2e3e5 -->
          <h3 class="bold text-light bg-secondary" style="font-size: large;">Payment Done</h3>
        </div>
        <!-- <div class="card shadow"> -->
        <div class="card-body pt-0 mt-0">
          <!-- <div class="w-100 ">
                    #e2e3e5
                    <h3 class=" bold text-light bg-dark">Work Order Pending</h3>
                  </div> -->
          <div class="card-body row mt-0 pt-0">
            <div class="border rounded custom-form-field">
              <mat-form-field class="filter-field w-100 " appearance="fill">
                <mat-label>Date Range</mat-label>
                <mat-date-range-input [rangePicker]="picker2" [formGroup]="dateRange1">
                  <input matStartDate placeholder="Start date" formControlName="start" class="custom-inputt">
                  <input matEndDate placeholder="End date" formControlName="end" class="custom-inputt">
                </mat-date-range-input>
                <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                <mat-date-range-picker #picker2></mat-date-range-picker>
              </mat-form-field>
            </div>
          </div>
          <div class="container-fluid  p-3">
            <div class="row" *ngIf="PaidSummaryScheme.length > 0;else other_content">
              <!-- <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="PaidSummaryTotal.length > 0"> -->
              <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="PaidSummaryScheme.length > 0">
                <div class="chart-container">
                  <span class="bold mt-1" style="color: rgb(110, 13, 37);">Duration: {{fromdt1}} To {{todt1}}</span>
                  <apx-chart [series]="chartPaid.series" [chart]="chartPaid.chart" [dataLabels]="chartPaid.dataLabels"
                    [plotOptions]="chartPaid.plotOptions" [xaxis]="chartPaid.xaxis" [stroke]="chartPaid.stroke"
                    [fill]="chartPaid.fill" [yaxis]="chartPaid.yaxis" [title]="chartPaid.title"
                    [tooltip]="chartPaid.tooltip" [legend]="chartPaid.legend"></apx-chart>
                </div>
              </div>
              <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="PaidSummaryDivision.length > 0">
                <div class="chart-container">
                  <span class="bold mt-1" style="color: rgb(110, 13, 37);">Duration: {{fromdt1}} To {{todt1}}</span>
                  <apx-chart [series]="chartPaid1.series" [chart]="chartPaid1.chart"
                    [dataLabels]="chartPaid1.dataLabels" [plotOptions]="chartPaid1.plotOptions"
                    [xaxis]="chartPaid1.xaxis" [stroke]="chartPaid1.stroke" [fill]="chartPaid1.fill"
                    [yaxis]="chartPaid1.yaxis" [title]="chartPaid1.title" [tooltip]="chartPaid1.tooltip"
                    [legend]="chartPaid1.legend"></apx-chart>
                </div>
              </div>
            </div>
            <ng-template class="row" #other_content>
              <strong style="font-size: 20px;">No Payment Done are currently available for the scheme.</strong>
            </ng-template>
            <!-- <div class="row">
                      <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="PaidSummaryScheme.length > 0">
                        <div class="chart-container">
                          <span class="bold mt-1" style="color: rgb(110, 13, 37);">Duration: {{fromdt}} To {{todt}}</span> 
                          <apx-chart [series]="chartPaid2.series" [chart]="chartPaid2.chart"
                            [dataLabels]="chartPaid2.dataLabels" [plotOptions]="chartPaid2.plotOptions"
                            [xaxis]="chartPaid2.xaxis" [stroke]="chartPaid2.stroke" [fill]="chartPaid2.fill"
                            [yaxis]="chartPaid2.yaxis" [title]="chartPaid2.title" [tooltip]="chartPaid2.tooltip"
                            [legend]="chartPaid2.legend"></apx-chart>
                        </div>
                      </div> 
                       <div class="col-lg-6 col-md-6 mb-2 border rounded" *ngIf="PaidSummaryDistrict.length > 0">
                        <div class="chart-container">
                          <apx-chart [series]="chartOptionsLine.series" [chart]="chartOptionsLine.chart"
                            [dataLabels]="chartOptionsLine.dataLabels" [plotOptions]="chartOptionsLine.plotOptions"
                            [xaxis]="chartOptionsLine.xaxis" [stroke]="chartOptionsLine.stroke" [fill]="chartOptionsLine.fill"
                            [yaxis]="chartOptionsLine.yaxis" [title]="chartOptionsLine.title"
                            [tooltip]="chartOptionsLine.tooltip" [legend]="chartOptionsLine.legend"></apx-chart>
                        </div>
                      </div> 
                    </div>-->
          </div>
        </div>

      </div>
    </div>
  </div>
</div>



  <!-- Math Modal -->
  <!-- >Total Works -->
  <ng-template class=" " #itemDetailsModalTW let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Progress Level:<span class="text-primary">Total Works</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{ totalNosWorks }}</span></h1>
        <!-- <h1>Progress Details WO Running Hand Details</h1> -->
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content style="margin-bottom: 15px;">
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterTW($event)">
          </div>
          <div class="export-menu-container">
            <button type="button" class="btn border rounded btn-outline-secondary" mat-button
              [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'TWorksAbstractD', sheet: 'TWorksAbstractD', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDFTW()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSource4" #exporter="matTableExporter" matSort #sortTW="matSort">

            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element">{{ element.work_id}}</td>
            </ng-container>
            <ng-container matColumnDef="grantNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head No</th>
              <td mat-cell *matCellDef="let element">{{ element.grantNo}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element">{{ element.head}} </td>
            </ng-container>


            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district}} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname}} </td>
            </ng-container>

            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element">{{ element.work}} </td>
            </ng-container>



            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
            </ng-container>
            <ng-container matColumnDef="timeAllowed">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Time Allowed</th>
              <td mat-cell *matCellDef="let element"> {{ element.timeAllowed}} </td>
            </ng-container>
            <ng-container matColumnDef="dueDTTimePerAdded">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Completion</th>
              <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded}} </td>
            </ng-container>
            <ng-container matColumnDef="lProgress">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress Level</th>
              <td mat-cell *matCellDef="let element"> {{ element.lProgress}} </td>
            </ng-container>
            <ng-container matColumnDef="progressDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.progressDT}} </td>
            </ng-container>
            <ng-container matColumnDef="expcompdt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Exp. Comp DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.expcompdt}} </td>
            </ng-container>
            <ng-container matColumnDef="delayreason">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Delay Reason</th>
              <td mat-cell *matCellDef="let element"> {{ element.delayreason}} </td>
            </ng-container>
            <ng-container matColumnDef="pRemarks">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
              <td mat-cell *matCellDef="let element"> {{ element.pRemarks}}/{{ element.remarks}} </td>
            </ng-container>

            <ng-container matColumnDef="subengname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.subengname}} </td>
            </ng-container>
            <ng-container matColumnDef="aeName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Asst.Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.aeName}} </td>
            </ng-container>
            <ng-container matColumnDef="aadt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aadt}} </td>
            </ng-container>

            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt}} </td>
            </ng-container>
            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container>

            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}} </td>
            </ng-container>
            <ng-container matColumnDef="tType">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Type</th>
              <td mat-cell *matCellDef="let element"> {{ element.tType}} </td>
            </ng-container>
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT Reference</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderReference}} </td>
            </ng-container>
            <ng-container matColumnDef="dateOfIssueNIT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT/Sanction DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.dateOfIssueNIT}}/ {{ element.dateOfSanction}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptanceLetterRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Acceptance Letter RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptanceLetterRefNo}} </td>
            </ng-container>
            <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/ {{ element.workorderRefNoGovt}}</td>
            </ng-container>
            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accepted DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Rate%</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionDetail">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionDetail}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contract Value(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract}} </td>
            </ng-container>
            <ng-container matColumnDef="totalpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="totalunpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Unpaid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalunpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme}} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter NO</th>
              <td mat-cell *matCellDef="let element">{{ element.letterNo}} </td>
            </ng-container>
            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element">{{ element.approver}} </td>
            </ng-container>
            <ng-container matColumnDef="divName_En">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.divName_En}} </td>
            </ng-container>
            <ng-container matColumnDef="cid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor ID/Class</th>
              <td mat-cell *matCellDef="let element"> {{ element.cid}}/{{ element.regType}} </td>
            </ng-container>

            <ng-container matColumnDef="mobNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor Mobile No</th>
              <td mat-cell *matCellDef="let element"> {{ element.mobNo}} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <tr mat-header-row
              *matHeaderRowDef="['sno','work_id','grantNo','head','district','blockname','work','wrokOrderDT','timeAllowed','dueDTTimePerAdded','lProgress','progressDT','expcompdt','delayreason','pRemarks','subengname','aeName','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','contractorNAme','letterNo','approver','divName_En','cid','mobNo','action']">
              <!-- *matHeaderRowDef="['sno','head','divName_En','district','blockname','letterNo','approver','work','tsDate','tsamt','tType','aadt','asAmt','tenderReference','acceptanceLetterRefNo','acceptLetterDT','totalAmountOfContract','work_id','action']"> -->
            </tr>
            <tr mat-row
              *matRowDef="let row; columns: ['sno','work_id','grantNo','head','district','blockname','work','wrokOrderDT','timeAllowed','dueDTTimePerAdded','lProgress','progressDT','expcompdt','delayreason','pRemarks','subengname','aeName','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','contractorNAme','letterNo','approver','divName_En','cid','mobNo','action']">
            </tr>
            <!-- <tr mat-header-row
            *matHeaderRowDef="['sno','head','divName_En','district','blockname','letterNo','approver','work','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','cid','contractorNAme','mobNo','lProgress','progressDT','expcompdt','delayreason','subengname','aeName','work_id','asLetter','action']">
             </tr>
           
            <tr mat-row
              *matRowDef="let row; columns: ['sno','head','divName_En','district','blockname','letterNo','approver','work','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','cid','contractorNAme','mobNo','lProgress','progressDT','expcompdt','delayreason','subengname','aeName','work_id','asLetter','action']">
            </tr> -->
          </table>
          <mat-paginator #paginatorTW [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>
    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer mt-2 p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>
  <!-- A/Works Order -->
  <ng-template class=" " #itemDetailsModal let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Progress Level:<span class="text-primary"> {{dashname}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{nosworks}}</span></h1>
        <!-- <h1>Progress Details WO Running Hand Details</h1> -->
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilter($event)">
          </div>
          <div class="export-menu-container">
            <button type="button" class="btn border rounded btn-outline-secondary" mat-button
              [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'WorksOrderD', sheet: 'WorksOrderD', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDF()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSource" #exporter="matTableExporter" matSort #sort="matSort">
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element">{{ element.work_id}}</td>
            </ng-container>
            <ng-container matColumnDef="grantNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head No</th>
              <td mat-cell *matCellDef="let element">{{ element.grantNo}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element">{{ element.head}} </td>
            </ng-container>


            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district}} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname}} </td>
            </ng-container>

            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element">{{ element.work}} </td>
            </ng-container>

            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accepted DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Rate%</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionDetail">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionDetail}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contract Value(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract}} </td>
            </ng-container>
            <ng-container matColumnDef="totalpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="totalunpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Unpaid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalunpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
            </ng-container>
            <ng-container matColumnDef="timeAllowed">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Time Allowed</th>
              <td mat-cell *matCellDef="let element"> {{ element.timeAllowed}} </td>
            </ng-container>
            <ng-container matColumnDef="dueDTTimePerAdded">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Completion</th>
              <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded}} </td>
            </ng-container>
            <ng-container matColumnDef="lProgress">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress Level</th>
              <td mat-cell *matCellDef="let element"> {{ element.lProgress}} </td>
            </ng-container>
            <ng-container matColumnDef="subengname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.subengname}} </td>
            </ng-container>
            <ng-container matColumnDef="aeName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Asst.Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.aeName}} </td>
            </ng-container>
            <ng-container matColumnDef="aadt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aadt}} </td>
            </ng-container>

            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt}} </td>
            </ng-container>
            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container>

            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}} </td>
            </ng-container>
            <ng-container matColumnDef="tType">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Type</th>
              <td mat-cell *matCellDef="let element"> {{ element.tType}} </td>
            </ng-container>
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT Reference</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderReference}} </td>
            </ng-container>
            <ng-container matColumnDef="dateOfIssueNIT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT/Sanction DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.dateOfIssueNIT}}/ {{ element.dateOfSanction}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptanceLetterRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Acceptance Letter RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptanceLetterRefNo}} </td>
            </ng-container>
            <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/ {{ element.workorderRefNoGovt}}</td>
            </ng-container>
            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme}} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter NO</th>
              <td mat-cell *matCellDef="let element">{{ element.letterNo}} </td>
            </ng-container>
            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element">{{ element.approver}} </td>
            </ng-container>
            <ng-container matColumnDef="divName_En">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.divName_En}} </td>
            </ng-container>
            <ng-container matColumnDef="cid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor ID/Class</th>
              <td mat-cell *matCellDef="let element"> {{ element.cid}}/{{ element.regType}} </td>
            </ng-container>

            <ng-container matColumnDef="mobNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor Mobile No</th>
              <td mat-cell *matCellDef="let element"> {{ element.mobNo}} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="asLetter">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter</th>
              <td mat-cell *matCellDef="let element"> {{ element.asLetter}} </td>
            </ng-container> -->
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <!-- test -->
            <!-- <ng-container matColumnDef="dateOfSanction">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Date Of Sanction</th>
                                <td mat-cell *matCellDef="let element"> {{ element.dateOfSanction}} </td>
                            </ng-container>    
                                     
                                      <ng-container matColumnDef="hoAllotedDT">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>HoAlloted DT</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.hoAllotedDT}} </td>
                                      </ng-container>
                                       <ng-container matColumnDef="workorderRefNoGovt">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNoGovt</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.workorderRefNoGovt}} </td>
                                      </ng-container> 
                                       <ng-container matColumnDef="regType">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Reg Type</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.regType}} </td>
                                      </ng-container>    
                                       <ng-container matColumnDef="class">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Class</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.class}} </td>
                                      </ng-container>  
                                       <ng-container matColumnDef="englishAddress">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Address</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.englishAddress}} </td>
                                      </ng-container>    
                                       <ng-container matColumnDef="groupName">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Group</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.groupName}} </td>
                                      </ng-container>     
                                       <ng-container matColumnDef="progressDT">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress DT</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.progressDT}} </td>
                                      </ng-container>    
                                       <ng-container matColumnDef="pRemarks">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>PRemarks</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.pRemarks}} </td>
                                      </ng-container>    
                                      <ng-container matColumnDef="remarks">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.remarks}} </td>
                                      </ng-container>    
                                      <ng-container matColumnDef="display">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Display</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.display}} </td>
                                      </ng-container>  
                                       <ng-container matColumnDef="descri">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Descri</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.descri}} </td> 
                                      </ng-container>  
                                       <ng-container matColumnDef="fmrcode">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Fmr Code</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.fmrcode}} </td>
                                      </ng-container>    
                                       <ng-container matColumnDef="expcompdt">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Exp comp DT</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.expcompdt}} </td>
                                      </ng-container> 
                                       <ng-container matColumnDef="delayreason">
                                          <th mat-header-cell *matHeaderCellDef mat-sort-header>Delay Reason</th>
                                          <td mat-cell *matCellDef="let element"> {{ element.delayreason}} </td>
                                      </ng-container>     -->
            <tr mat-header-row
              *matHeaderRowDef="['sno','work_id','grantNo','head','district','blockname','work','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','wrokOrderDT','timeAllowed','dueDTTimePerAdded','lProgress','subengname','aeName','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','contractorNAme','letterNo','approver','divName_En','cid','mobNo','action']">
              <!-- *matHeaderRowDef="['sno','head','divName_En','district','blockname','letterNo','approver','work','tsDate','tsamt','tType','aadt','asAmt','tenderReference','acceptanceLetterRefNo','acceptLetterDT','totalAmountOfContract','work_id','action']"> -->
            </tr>
            <!-- Data Rows -->
            <tr mat-row
              *matRowDef="let row; columns: ['sno','work_id','grantNo','head','district','blockname','work','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','wrokOrderDT','timeAllowed','dueDTTimePerAdded','lProgress','subengname','aeName','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','contractorNAme','letterNo','approver','divName_En','cid','mobNo','action']">
            </tr>
          </table>
          <mat-paginator #paginator [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer mt-2 p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>
  <!-- Complete And Handover -->
  <ng-template class=" " #itemDetailsModalCom_Han let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Progress Level:<span class="text-primary"> {{dashname}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{nosworks}}</span></h1>
        <!-- <h1>Progress Details WO Running Hand Details</h1> -->
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterCom_Han($event)">
          </div>
          <div class="export-menu-container">
            <button type="button" class="btn border rounded btn-outline-secondary" mat-button
              [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'CompleteAndHandover', sheet: 'CompleteAndHandover', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDFCom_Han()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSourceCom_Han" #exporter="matTableExporter" matSort #sortCom_Han="matSort">
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element">{{ element.work_id}}</td>
            </ng-container>
            <ng-container matColumnDef="grantNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head No</th>
              <td mat-cell *matCellDef="let element">{{ element.grantNo}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element">{{ element.head}} </td>
            </ng-container>


            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district}} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname}} </td>
            </ng-container>

            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element">{{ element.work}} </td>
            </ng-container>

            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accepted DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Rate%</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionDetail">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionDetail}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contract Value(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract}} </td>
            </ng-container>
            <ng-container matColumnDef="totalpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="totalunpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Unpaid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalunpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
            </ng-container>
            <ng-container matColumnDef="timeAllowed">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Time Allowed</th>
              <td mat-cell *matCellDef="let element"> {{ element.timeAllowed}} </td>
            </ng-container>
            <ng-container matColumnDef="dueDTTimePerAdded">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Completion</th>
              <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded}} </td>
            </ng-container>
            <ng-container matColumnDef="lProgress">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress Level</th>
              <td mat-cell *matCellDef="let element"> {{ element.lProgress}} </td>
            </ng-container>
            <ng-container matColumnDef="progressDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Completion DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.progressDT}} </td>
            </ng-container>
            <ng-container matColumnDef="subengname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.subengname}} </td>
            </ng-container>
            <ng-container matColumnDef="aeName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Asst.Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.aeName}} </td>
            </ng-container>
            <ng-container matColumnDef="aadt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aadt}} </td>
            </ng-container>

            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt}} </td>
            </ng-container>
            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container>

            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}} </td>
            </ng-container>
            <ng-container matColumnDef="tType">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Type</th>
              <td mat-cell *matCellDef="let element"> {{ element.tType}} </td>
            </ng-container>
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT Reference</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderReference}} </td>
            </ng-container>
            <ng-container matColumnDef="dateOfIssueNIT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT/Sanction DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.dateOfIssueNIT}}/ {{ element.dateOfSanction}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptanceLetterRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Acceptance Letter RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptanceLetterRefNo}} </td>
            </ng-container>
            <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/ {{ element.workorderRefNoGovt}}</td>
            </ng-container>
            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme}} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter NO</th>
              <td mat-cell *matCellDef="let element">{{ element.letterNo}} </td>
            </ng-container>
            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element">{{ element.approver}} </td>
            </ng-container>
            <ng-container matColumnDef="divName_En">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.divName_En}} </td>
            </ng-container>
            <ng-container matColumnDef="cid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor ID/Class</th>
              <td mat-cell *matCellDef="let element"> {{ element.cid}}/{{ element.regType}} </td>
            </ng-container>

            <ng-container matColumnDef="mobNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor Mobile No</th>
              <td mat-cell *matCellDef="let element"> {{ element.mobNo}} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <tr mat-header-row
              *matHeaderRowDef="['sno','work_id','grantNo','head','district','blockname','work','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','wrokOrderDT','timeAllowed','dueDTTimePerAdded','lProgress','progressDT','subengname','aeName','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','contractorNAme','letterNo','approver','divName_En','cid','mobNo','action']">
              <!-- *matHeaderRowDef="['sno','head','divName_En','district','blockname','letterNo','approver','work','tsDate','tsamt','tType','aadt','asAmt','tenderReference','acceptanceLetterRefNo','acceptLetterDT','totalAmountOfContract','work_id','action']"> -->
            </tr>
            <tr mat-row
              *matRowDef="let row; columns: ['sno','work_id','grantNo','head','district','blockname','work','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','wrokOrderDT','timeAllowed','dueDTTimePerAdded','lProgress','progressDT','subengname','aeName','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','contractorNAme','letterNo','approver','divName_En','cid','mobNo','action']">
            </tr>
            <!-- <tr mat-header-row
            *matHeaderRowDef="['sno','head','divName_En','district','blockname','letterNo','approver','work','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','cid','contractorNAme','mobNo','lProgress','progressDT','subengname','aeName','work_id','asLetter','action']">
           </tr>
            <tr mat-row
              *matRowDef="let row; columns: ['sno','head','divName_En','district','blockname','letterNo','approver','work','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','cid','contractorNAme','mobNo','lProgress','progressDT','subengname','aeName','work_id','asLetter','action']">
            </tr> -->
          </table>
          <mat-paginator #paginatorCom_Han [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer mt-2 p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>
  <!-- Running Works -->
  <ng-template class=" " #itemDetailsModalRun_Work let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Progress Level:<span class="text-primary"> {{dashname}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{nosworks}}</span></h1>
        <!-- <h1>Progress Details WO Running Hand Details</h1> -->
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterRun_Work($event)">
          </div>
          <div class="export-menu-container">
            <button type="button" class="btn border rounded btn-outline-secondary" mat-button
              [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'RunningWorks', sheet: 'RunningWorks', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDFRun_Work()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSourceRun_Work" #exporter="matTableExporter" matSort #sortRun_Work="matSort">
            <!-- <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element">{{ element.head}} </td>
            </ng-container>
            <ng-container matColumnDef="divName_En">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.divName_En}} </td>
            </ng-container>
            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district}} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname}} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter NO</th>
              <td mat-cell *matCellDef="let element">{{ element.letterNo}} </td>
            </ng-container>
            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element">{{ element.approver}} </td>
            </ng-container>
            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element">{{ element.work}} </td>
            </ng-container>
            <ng-container matColumnDef="aadt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aadt}} </td>
            </ng-container>
          
            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt}} </td>
            </ng-container>
            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container>
          
            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}} </td>
            </ng-container>
            <ng-container matColumnDef="tType">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Type</th>
              <td mat-cell *matCellDef="let element"> {{ element.tType}} </td>
            </ng-container>
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT Reference</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderReference}} </td>
            </ng-container>
            <ng-container matColumnDef="dateOfIssueNIT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT/Sanction DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.dateOfIssueNIT}}/ {{ element.dateOfSanction}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptanceLetterRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Acceptance Letter RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptanceLetterRefNo}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accepted DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Rate%</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionDetail">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionDetail}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Amount Of Contract(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract}} </td>
            </ng-container>
            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
            </ng-container>
            <ng-container matColumnDef="timeAllowed">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Time Allowed</th>
              <td mat-cell *matCellDef="let element"> {{ element.timeAllowed}} </td>
            </ng-container>
            <ng-container matColumnDef="dueDTTimePerAdded">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Time PerAdded</th>
              <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded}} </td>
            </ng-container>
          
            <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/ {{ element.workorderRefNoGovt}}</td>
            </ng-container>
            <ng-container matColumnDef="cid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor ID/Class</th>
              <td mat-cell *matCellDef="let element"> {{ element.cid}}/{{ element.regType}} </td>
            </ng-container>
            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme}} </td>
            </ng-container>
            <ng-container matColumnDef="mobNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor Mobile No</th>
              <td mat-cell *matCellDef="let element"> {{ element.mobNo}} </td>
            </ng-container>
            <ng-container matColumnDef="lProgress">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>lProgress</th>
              <td mat-cell *matCellDef="let element"> {{ element.lProgress}} </td>
            </ng-container>
            <ng-container matColumnDef="progressDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.progressDT}} </td>
          </ng-container> 
          <ng-container matColumnDef="expcompdt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Exp. Comp DT</th>
            <td mat-cell *matCellDef="let element"> {{ element.expcompdt}} </td>
        </ng-container> 
         <ng-container matColumnDef="delayreason">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Delay Reason</th>
            <td mat-cell *matCellDef="let element"> {{ element.delayreason}} </td>
        </ng-container> 
            <ng-container matColumnDef="subengname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.subengname}} </td>
            </ng-container>
            <ng-container matColumnDef="aeName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Asst.Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.aeName}} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element">{{ element.work_id}}</td>
            </ng-container>
            <ng-container matColumnDef="asLetter">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter</th>
              <td mat-cell *matCellDef="let element"> {{ element.asLetter}} </td>
            </ng-container> -->
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element">{{ element.work_id}}</td>
            </ng-container>
            <ng-container matColumnDef="grantNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head No</th>
              <td mat-cell *matCellDef="let element">{{ element.grantNo}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element">{{ element.head}} </td>
            </ng-container>


            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district}} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname}} </td>
            </ng-container>

            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element">{{ element.work}} </td>
            </ng-container>



            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
            </ng-container>
            <ng-container matColumnDef="timeAllowed">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Time Allowed</th>
              <td mat-cell *matCellDef="let element"> {{ element.timeAllowed}} </td>
            </ng-container>
            <ng-container matColumnDef="dueDTTimePerAdded">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Completion</th>
              <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded}} </td>
            </ng-container>
            <ng-container matColumnDef="lProgress">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress Level</th>
              <td mat-cell *matCellDef="let element"> {{ element.lProgress}} </td>
            </ng-container>
            <ng-container matColumnDef="progressDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.progressDT}} </td>
            </ng-container>
            <ng-container matColumnDef="expcompdt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Exp. Comp DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.expcompdt}} </td>
            </ng-container>
            <ng-container matColumnDef="delayreason">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Delay Reason</th>
              <td mat-cell *matCellDef="let element"> {{ element.delayreason}} </td>
            </ng-container>
            <ng-container matColumnDef="PRemarks">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
              <td mat-cell *matCellDef="let element"> {{ element.PRemarks}}/{{ element.Remarks}} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="Remarks">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
            <td mat-cell *matCellDef="let element"> {{ element.Remarks}} </td>
        </ng-container>  -->

            <ng-container matColumnDef="subengname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.subengname}} </td>
            </ng-container>
            <ng-container matColumnDef="aeName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Asst.Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.aeName}} </td>
            </ng-container>
            <ng-container matColumnDef="aadt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aadt}} </td>
            </ng-container>

            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt}} </td>
            </ng-container>
            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container>

            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}} </td>
            </ng-container>
            <ng-container matColumnDef="tType">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Type</th>
              <td mat-cell *matCellDef="let element"> {{ element.tType}} </td>
            </ng-container>
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT Reference</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderReference}} </td>
            </ng-container>
            <ng-container matColumnDef="dateOfIssueNIT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT/Sanction DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.dateOfIssueNIT}}/ {{ element.dateOfSanction}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptanceLetterRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Acceptance Letter RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptanceLetterRefNo}} </td>
            </ng-container>
            <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/ {{ element.workorderRefNoGovt}}</td>
            </ng-container>
            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accepted DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Rate%</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionDetail">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionDetail}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contract Value(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract}} </td>
            </ng-container>
            <ng-container matColumnDef="totalpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="totalunpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Unpaid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalunpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme}} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter NO</th>
              <td mat-cell *matCellDef="let element">{{ element.letterNo}} </td>
            </ng-container>
            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element">{{ element.approver}} </td>
            </ng-container>
            <ng-container matColumnDef="divName_En">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.divName_En}} </td>
            </ng-container>
            <ng-container matColumnDef="cid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor ID/Class</th>
              <td mat-cell *matCellDef="let element"> {{ element.cid}}/{{ element.regType}} </td>
            </ng-container>

            <ng-container matColumnDef="mobNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor Mobile No</th>
              <td mat-cell *matCellDef="let element"> {{ element.mobNo}} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <tr mat-header-row
              *matHeaderRowDef="['sno','work_id','grantNo','head','district','blockname','work','wrokOrderDT','timeAllowed','dueDTTimePerAdded','lProgress','progressDT','expcompdt','delayreason','PRemarks','subengname','aeName','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','contractorNAme','letterNo','approver','divName_En','cid','mobNo','action']">
              <!-- *matHeaderRowDef="['sno','head','divName_En','district','blockname','letterNo','approver','work','tsDate','tsamt','tType','aadt','asAmt','tenderReference','acceptanceLetterRefNo','acceptLetterDT','totalAmountOfContract','work_id','action']"> -->
            </tr>
            <tr mat-row
              *matRowDef="let row; columns: ['sno','work_id','grantNo','head','district','blockname','work','wrokOrderDT','timeAllowed','dueDTTimePerAdded','lProgress','progressDT','expcompdt','delayreason','PRemarks','subengname','aeName','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','contractorNAme','letterNo','approver','divName_En','cid','mobNo','action']">
            </tr>
            <!-- <tr mat-header-row
            *matHeaderRowDef="['sno','head','divName_En','district','blockname','letterNo','approver','work','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','cid','contractorNAme','mobNo','lProgress','progressDT','expcompdt','delayreason','subengname','aeName','work_id','asLetter','action']">
             </tr>
           
            <tr mat-row
              *matRowDef="let row; columns: ['sno','head','divName_En','district','blockname','letterNo','approver','work','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','cid','contractorNAme','mobNo','lProgress','progressDT','expcompdt','delayreason','subengname','aeName','work_id','asLetter','action']">
            </tr> -->
          </table>
          <mat-paginator #paginatorRun_Work [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto mt-2 footer p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>

  <!-- Land Not Alloted/Land Dispute -->
  <ng-template class=" " #itemDetailsModalLand_isu let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Progress Level:<span class="text-primary"> {{dashname}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{nosworks}}</span></h1>
        <!-- <h1>Land Issue Details</h1> -->
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterLand_isu($event)">
          </div>
          <div class="export-menu-container">
            <button type="button" class="btn border rounded btn-outline-secondary" mat-button
              [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'LandNotAlloted', sheet: 'LandNotAlloted', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="expor_PDFLand_isu()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded w-100" mat-table matTableExporter
            [dataSource]="dataSourceLand_isu" #exporter="matTableExporter" matSort #sortLand_isu="matSort">
            <!-- <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element">{{ element.head}} </td>
            </ng-container>
            <ng-container matColumnDef="divName_En">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.divName_En}} </td>
            </ng-container>
            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district}} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname}} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter NO</th>
              <td mat-cell *matCellDef="let element">{{ element.letterNo}} </td>
            </ng-container>
            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element">{{ element.approver}} </td>
            </ng-container>
            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element">{{ element.work}} </td>
            </ng-container>
            <ng-container matColumnDef="aadt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aadt}} </td>
            </ng-container>
          
            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt}} </td>
            </ng-container>
            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container>
          
            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}} </td>
            </ng-container>
            <ng-container matColumnDef="tType">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Type</th>
              <td mat-cell *matCellDef="let element"> {{ element.tType}} </td>
            </ng-container>
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT Reference</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderReference}} </td>
            </ng-container>
            <ng-container matColumnDef="dateOfIssueNIT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT/Sanction DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.dateOfIssueNIT}}/ {{ element.dateOfSanction}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptanceLetterRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Acceptance Letter RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptanceLetterRefNo}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accepted DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Rate%</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionDetail">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionDetail}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Amount Of Contract(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract}} </td>
            </ng-container>
            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
            </ng-container>
            <ng-container matColumnDef="timeAllowed">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Time Allowed</th>
              <td mat-cell *matCellDef="let element"> {{ element.timeAllowed}} </td>
            </ng-container>
            <ng-container matColumnDef="dueDTTimePerAdded">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Time PerAdded</th>
              <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded}} </td>
            </ng-container>
          
            <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/ {{ element.workorderRefNoGovt}}</td>
            </ng-container>
            <ng-container matColumnDef="cid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor ID/Class</th>
              <td mat-cell *matCellDef="let element"> {{ element.cid}}/{{ element.regType}} </td>
            </ng-container>
            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme}} </td>
            </ng-container>
            <ng-container matColumnDef="mobNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor Mobile No</th>
              <td mat-cell *matCellDef="let element"> {{ element.mobNo}} </td>
            </ng-container>
            <ng-container matColumnDef="lProgress">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>lProgress</th>
              <td mat-cell *matCellDef="let element"> {{ element.lProgress}} </td>
            </ng-container>
            <ng-container matColumnDef="progressDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.progressDT}} </td>
          </ng-container> 
          <ng-container matColumnDef="expcompdt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Exp. Comp DT</th>
            <td mat-cell *matCellDef="let element"> {{ element.expcompdt}} </td>
        </ng-container> 
         <ng-container matColumnDef="delayreason">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Delay Reason</th>
            <td mat-cell *matCellDef="let element"> {{ element.delayreason}} </td>
        </ng-container> 
            <ng-container matColumnDef="subengname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.subengname}} </td>
            </ng-container>
            <ng-container matColumnDef="aeName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Asst.Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.aeName}} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element">{{ element.work_id}}</td>
            </ng-container>
            <ng-container matColumnDef="asLetter">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter</th>
              <td mat-cell *matCellDef="let element"> {{ element.asLetter}} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded" mat-button
                    (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container> -->


            <!-- <tr mat-header-row
              *matHeaderRowDef="['sno','head','divName_En','district','blockname','letterNo','approver','work','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','cid','contractorNAme','mobNo','lProgress','progressDT','expcompdt','delayreason','subengname','aeName','work_id','asLetter','action']">
            </tr>
            <tr mat-row
              *matRowDef="let row; columns: ['sno','head','divName_En','district','blockname','letterNo','approver','work','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','cid','contractorNAme','mobNo','lProgress','progressDT','expcompdt','delayreason','subengname','aeName','work_id','asLetter','action']">
            </tr> -->
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element">{{ element.work_id}}</td>
            </ng-container>
            <ng-container matColumnDef="grantNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head No</th>
              <td mat-cell *matCellDef="let element">{{ element.grantNo}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element">{{ element.head}} </td>
            </ng-container>


            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district}} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname}} </td>
            </ng-container>

            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element">{{ element.work}} </td>
            </ng-container>
            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
            </ng-container>
            <ng-container matColumnDef="timeAllowed">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Time Allowed</th>
              <td mat-cell *matCellDef="let element"> {{ element.timeAllowed}} </td>
            </ng-container>
            <ng-container matColumnDef="dueDTTimePerAdded">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Completion</th>
              <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded}} </td>
            </ng-container>
            <ng-container matColumnDef="lProgress">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress Level</th>
              <td mat-cell *matCellDef="let element"> {{ element.lProgress}} </td>
            </ng-container>
            <ng-container matColumnDef="progressDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.progressDT}} </td>
            </ng-container>

            <ng-container matColumnDef="delayreason">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Delay Reason</th>
              <td mat-cell *matCellDef="let element"> {{ element.delayreason}} </td>
            </ng-container>
            <ng-container matColumnDef="PRemarks">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
              <td mat-cell *matCellDef="let element"> {{ element.PRemarks}}/{{ element.Remarks}} </td>
            </ng-container>
            <ng-container matColumnDef="expcompdt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Exp. Comp DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.expcompdt}} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="Remarks">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
            <td mat-cell *matCellDef="let element"> {{ element.Remarks}} </td>
        </ng-container>  -->

            <ng-container matColumnDef="subengname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.subengname}} </td>
            </ng-container>
            <ng-container matColumnDef="aeName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Asst.Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.aeName}} </td>
            </ng-container>
            <ng-container matColumnDef="aadt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aadt}} </td>
            </ng-container>

            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt}} </td>
            </ng-container>
            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container>

            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}} </td>
            </ng-container>
            <ng-container matColumnDef="tType">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Type</th>
              <td mat-cell *matCellDef="let element"> {{ element.tType}} </td>
            </ng-container>
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT Reference</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderReference}} </td>
            </ng-container>
            <ng-container matColumnDef="dateOfIssueNIT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT/Sanction DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.dateOfIssueNIT}}/ {{ element.dateOfSanction}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptanceLetterRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Acceptance Letter RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptanceLetterRefNo}} </td>
            </ng-container>
            <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/ {{ element.workorderRefNoGovt}}</td>
            </ng-container>
            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accepted DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Rate%</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionDetail">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionDetail}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contract Value(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract}} </td>
            </ng-container>
            <ng-container matColumnDef="totalpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="totalunpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Unpaid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalunpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme}} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter NO</th>
              <td mat-cell *matCellDef="let element">{{ element.letterNo}} </td>
            </ng-container>
            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element">{{ element.approver}} </td>
            </ng-container>
            <ng-container matColumnDef="divName_En">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.divName_En}} </td>
            </ng-container>
            <ng-container matColumnDef="cid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor ID/Class</th>
              <td mat-cell *matCellDef="let element"> {{ element.cid}}/{{ element.regType}} </td>
            </ng-container>

            <ng-container matColumnDef="mobNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor Mobile No</th>
              <td mat-cell *matCellDef="let element"> {{ element.mobNo}} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <tr mat-header-row
              *matHeaderRowDef="['sno','work_id','grantNo','head','district','blockname','work','wrokOrderDT','timeAllowed','dueDTTimePerAdded','lProgress','progressDT','delayreason','PRemarks','expcompdt','subengname','aeName','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','contractorNAme','letterNo','approver','divName_En','cid','mobNo','action']">
            </tr>
            <tr mat-row
              *matRowDef="let row; columns: ['sno','work_id','grantNo','head','district','blockname','work','wrokOrderDT','timeAllowed','dueDTTimePerAdded','lProgress','progressDT','delayreason','PRemarks','expcompdt','subengname','aeName','aadt','asAmt','tsDate','tsamt','tType','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','contractorNAme','letterNo','approver','divName_En','cid','mobNo','action']">
            </tr>
          </table>
          <mat-paginator #paginatorLand_isu [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer mt-2 p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>
  <!-- Land Issue Details -->
  <ng-template class=" " #itemDetailsModal1 let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Progress Level:<span class="text-primary"> {{dashname}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{nosworks}}</span></h1>
        <!-- <h1>Land Issue Details</h1> -->
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilter($event)">
          </div>
          <div class="export-menu-container">
            <button type="button" class="btn border rounded btn-outline-secondary" mat-button
              [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'LandIssueDetails', sheet: 'LandIssueDetails', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDF()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSource1" #exporter="matTableExporter" matSort #sort1="matSort">
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>
            <ng-container matColumnDef="grantNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head No</th>
              <td mat-cell *matCellDef="let element">{{ element.grantNo}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element">{{ element.head}} </td>
            </ng-container>
            <ng-container matColumnDef="divName_En">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.divName_En}} </td>
            </ng-container>
            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district}} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname}} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter NO</th>
              <td mat-cell *matCellDef="let element">{{ element.letterNo}} </td>
            </ng-container>
            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element">{{ element.approver}} </td>
            </ng-container>
            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element">{{ element.work}} </td>
            </ng-container>
            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container>
            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}} </td>
            </ng-container>
            <ng-container matColumnDef="tType">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TType</th>
              <td mat-cell *matCellDef="let element"> {{ element.tType}} </td>
            </ng-container>

            <ng-container matColumnDef="aadt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aadt}} </td>
            </ng-container>

            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt}} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="workname">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Works</th>
                        <td mat-cell *matCellDef="let element"> {{ element.workname}} </td>
                    </ng-container> -->
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Reference</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderReference}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptanceLetterRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Acceptance Letter RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptanceLetterRefNo}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accept LetterDT</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Amount Of Contract(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract}} </td>
            </ng-container>
            <ng-container matColumnDef="totalpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="totalunpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Unpaid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalunpaid}} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="sanctionRate">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction Rate</th>
                        <td mat-cell *matCellDef="let element"> {{ element.sanctionRate}} </td>
                    </ng-container>
                    <ng-container matColumnDef="sanctionDetail">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction Detail</th>
                        <td mat-cell *matCellDef="let element"> {{ element.sanctionDetail}} </td>
                    </ng-container>
                    <ng-container matColumnDef="wrokOrderDT">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Work OrderDT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
                    </ng-container>
                    <ng-container matColumnDef="hoAllotedDT">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>HoAlloted DT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.hoAllotedDT}} </td>
                    </ng-container>
                    <ng-container matColumnDef="agreementRefNo">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Agreement RefNo</th>
                        <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}} </td>
                    </ng-container>
                    <ng-container matColumnDef="workorderRefNoGovt">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNoGovt</th>
                        <td mat-cell *matCellDef="let element"> {{ element.workorderRefNoGovt}} </td>
                    </ng-container>
                    <ng-container matColumnDef="dueDTTimePerAdded">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Time PerAdded</th>
                        <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded}} </td>
                    </ng-container>
                    <ng-container matColumnDef="timeAllowed">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Time Allowed</th>
                        <td mat-cell *matCellDef="let element"> {{ element.timeAllowed}} </td>
                    </ng-container>
                    <ng-container matColumnDef="dateOfSanction">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Date Of Sanction</th>
                        <td mat-cell *matCellDef="let element"> {{ element.dateOfSanction}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="dateOfIssueNIT">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Date Of IssueNIT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.dateOfIssueNIT}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="cid">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>CID</th>
                        <td mat-cell *matCellDef="let element"> {{ element.cid}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="contractorNAme">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
                        <td mat-cell *matCellDef="let element"> {{ element.contractorNAme}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="regType">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Reg Type</th>
                        <td mat-cell *matCellDef="let element"> {{ element.regType}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="class">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Class</th>
                        <td mat-cell *matCellDef="let element"> {{ element.class}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="englishAddress">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Address</th>
                        <td mat-cell *matCellDef="let element"> {{ element.englishAddress}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="mobNo">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Mobile No</th>
                        <td mat-cell *matCellDef="let element"> {{ element.mobNo}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="asLetter">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter</th>
                        <td mat-cell *matCellDef="let element"> {{ element.asLetter}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="groupName">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Group</th>
                        <td mat-cell *matCellDef="let element"> {{ element.groupName}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="lProgress">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>lProgress</th>
                        <td mat-cell *matCellDef="let element"> {{ element.lProgress}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="progressDT">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress DT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.progressDT}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="pRemarks">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>PRemarks</th>
                        <td mat-cell *matCellDef="let element"> {{ element.pRemarks}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="remarks">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
                        <td mat-cell *matCellDef="let element"> {{ element.remarks}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="display">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Display</th>
                        <td mat-cell *matCellDef="let element"> {{ element.display}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="descri">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Descri</th>
                        <td mat-cell *matCellDef="let element"> {{ element.descri}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="fmrcode">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Fmr Code</th>
                        <td mat-cell *matCellDef="let element"> {{ element.fmrcode}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="expcompdt">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Exp comp DT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.expcompdt}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="delayreason">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Delay Reason</th>
                        <td mat-cell *matCellDef="let element"> {{ element.delayreason}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="subengname">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Eng name</th>
                        <td mat-cell *matCellDef="let element"> {{ element.subengname}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="aeName">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>AE Name</th>
                        <td mat-cell *matCellDef="let element"> {{ element.aeName}} </td>
                    </ng-container>     -->
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element">{{ element.work_id}}</td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <!-- <button class="btn btn-light btn-sm btn-outline-secondary align-items-center" [ngClass]="[value == 'Active' ? 'btn-secondary' : 'btn-light']"  mat-button (click)="onButtonClick(element.asid,0)"> -->
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <tr mat-header-row
              *matHeaderRowDef="['sno','grantNo','head','divName_En','district','blockname','letterNo','approver','work','tsDate','tsamt','tType','aadt','asAmt','tenderReference','acceptanceLetterRefNo','acceptLetterDT','totalAmountOfContract','totalpaid','totalunpaid','work_id','action']">
            </tr>
            <!-- Data Rows -->
            <tr mat-row
              *matRowDef="let row; columns: ['sno','grantNo','head','divName_En','district','blockname','letterNo','approver','work','tsDate','tsamt','tType','aadt','asAmt','tenderReference','acceptanceLetterRefNo','acceptLetterDT','totalAmountOfContract','totalpaid','totalunpaid','work_id','action']">
            </tr>
          </table>
          <mat-paginator #paginator1 [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>
    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>
  <!-- Tobe Tender All Details-->
  <ng-template class=" " #itemDetailsModal2 let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Progress Level:<span class="text-primary"> {{dashname}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{nosworks}}</span></h1>
        <!-- <h1> Tobe Tender All Details</h1> -->
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter"
              (keyup)="applyTextFilter_tobeTenderAll($event)">
          </div>
          <div class="export-menu-container">
            <button type="button" class="btn border rounded btn-outline-secondary" mat-button
              [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'TobeTenderAll', sheet: 'TobeTenderAll', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportobeTenderAll_PDFT()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSource2" #exporter="matTableExporter" matSort #sort2="matSort">
            <!-- <ng-container matColumnDef="sno">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
                        <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
                    </ng-container>
                    <ng-container matColumnDef="head">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
                        <td mat-cell *matCellDef="let element">{{ element.head}} </td>
                    </ng-container>
                    <ng-container matColumnDef="divName_En">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
                      <td mat-cell *matCellDef="let element"> {{ element.divName_En}} </td>
                  </ng-container>
                  <ng-container matColumnDef="district">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
                      <td mat-cell *matCellDef="let element"> {{ element.district}} </td>
                  </ng-container>
                  <ng-container matColumnDef="blockname">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
                      <td mat-cell *matCellDef="let element"> {{ element.blockname}} </td>
                  </ng-container>
                    <ng-container matColumnDef="letterNo">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter NO</th>
                        <td mat-cell *matCellDef="let element">{{ element.letterNo}} </td>
                    </ng-container>
                    <ng-container matColumnDef="approver">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
                        <td mat-cell *matCellDef="let element">{{ element.approver}} </td>
                    </ng-container>
                    <ng-container matColumnDef="work">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
                        <td mat-cell *matCellDef="let element">{{ element.work}} </td>
                    </ng-container>
                    <ng-container matColumnDef="tsDate">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
                      <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
                  </ng-container>
                    <ng-container matColumnDef="tsamt">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
                        <td mat-cell *matCellDef="let element"> {{ element.tsamt}} </td>
                    </ng-container>
                    <ng-container matColumnDef="tType">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>TType</th>
                        <td mat-cell *matCellDef="let element"> {{ element.tType}} </td>
                    </ng-container>
                 
                    <ng-container matColumnDef="aadt">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
                        <td mat-cell *matCellDef="let element"> {{ element.aadt}} </td>
                    </ng-container>
  
                    <ng-container matColumnDef="asAmt">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
                      <td mat-cell *matCellDef="let element"> {{ element.asAmt}} </td>
                    </ng-container>
                    <ng-container matColumnDef="tenderReference">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Reference</th>
                        <td mat-cell *matCellDef="let element">{{ element.tenderReference}} </td>
                    </ng-container>
                    <ng-container matColumnDef="acceptanceLetterRefNo">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Acceptance Letter RefNo</th>
                        <td mat-cell *matCellDef="let element"> {{ element.acceptanceLetterRefNo}} </td>
                    </ng-container>
                    <ng-container matColumnDef="acceptLetterDT">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Accept LetterDT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT}} </td>
                    </ng-container>
                    <ng-container matColumnDef="totalAmountOfContract">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Amount Of Contract(In Lacs)</th>
                        <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract}} </td>
                    </ng-container> 
                    <ng-container matColumnDef="sanctionRate">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction Rate</th>
                        <td mat-cell *matCellDef="let element"> {{ element.sanctionRate}} </td>
                    </ng-container>
                    <ng-container matColumnDef="sanctionDetail">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction Detail</th>
                        <td mat-cell *matCellDef="let element"> {{ element.sanctionDetail}} </td>
                    </ng-container>
                    <ng-container matColumnDef="wrokOrderDT">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Work OrderDT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
                    </ng-container>
                    <ng-container matColumnDef="hoAllotedDT">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>HoAlloted DT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.hoAllotedDT}} </td>
                    </ng-container>
                    <ng-container matColumnDef="agreementRefNo">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Agreement RefNo</th>
                        <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}} </td>
                    </ng-container>
                    <ng-container matColumnDef="workorderRefNoGovt">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNoGovt</th>
                        <td mat-cell *matCellDef="let element"> {{ element.workorderRefNoGovt}} </td>
                    </ng-container>
                    <ng-container matColumnDef="dueDTTimePerAdded">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Time PerAdded</th>
                        <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded}} </td>
                    </ng-container>
                    <ng-container matColumnDef="timeAllowed">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Time Allowed</th>
                        <td mat-cell *matCellDef="let element"> {{ element.timeAllowed}} </td>
                    </ng-container>
                    <ng-container matColumnDef="dateOfSanction">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Date Of Sanction</th>
                        <td mat-cell *matCellDef="let element"> {{ element.dateOfSanction}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="dateOfIssueNIT">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Date Of IssueNIT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.dateOfIssueNIT}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="cid">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>CID</th>
                        <td mat-cell *matCellDef="let element"> {{ element.cid}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="contractorNAme">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
                        <td mat-cell *matCellDef="let element"> {{ element.contractorNAme}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="regType">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Reg Type</th>
                        <td mat-cell *matCellDef="let element"> {{ element.regType}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="class">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Class</th>
                        <td mat-cell *matCellDef="let element"> {{ element.class}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="englishAddress">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Address</th>
                        <td mat-cell *matCellDef="let element"> {{ element.englishAddress}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="mobNo">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Mobile No</th>
                        <td mat-cell *matCellDef="let element"> {{ element.mobNo}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="asLetter">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter</th>
                        <td mat-cell *matCellDef="let element"> {{ element.asLetter}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="groupName">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Group</th>
                        <td mat-cell *matCellDef="let element"> {{ element.groupName}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="lProgress">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>lProgress</th>
                        <td mat-cell *matCellDef="let element"> {{ element.lProgress}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="progressDT">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress DT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.progressDT}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="pRemarks">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>PRemarks</th>
                        <td mat-cell *matCellDef="let element"> {{ element.pRemarks}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="remarks">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
                        <td mat-cell *matCellDef="let element"> {{ element.remarks}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="display">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Display</th>
                        <td mat-cell *matCellDef="let element"> {{ element.display}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="descri">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Descri</th>
                        <td mat-cell *matCellDef="let element"> {{ element.descri}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="fmrcode">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Fmr Code</th>
                        <td mat-cell *matCellDef="let element"> {{ element.fmrcode}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="expcompdt">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Exp comp DT</th>
                        <td mat-cell *matCellDef="let element"> {{ element.expcompdt}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="delayreason">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Delay Reason</th>
                        <td mat-cell *matCellDef="let element"> {{ element.delayreason}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="subengname">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Eng name</th>
                        <td mat-cell *matCellDef="let element"> {{ element.subengname}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="aeName">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>AE Name</th>
                        <td mat-cell *matCellDef="let element"> {{ element.aeName}} </td>
                    </ng-container>    
                    <ng-container matColumnDef="work_id">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
                        <td mat-cell *matCellDef="let element">{{ element.work_id}}</td>
                    </ng-container> -->
            <!-- <tr mat-header-row
                        *matHeaderRowDef="['sno','head','divName_En','district','blockname','letterNo','approver','work','tsDate','tsamt','tType','aadt','asAmt','tenderReference','acceptanceLetterRefNo','acceptLetterDT','totalAmountOfContract','work_id']">
                    </tr>
                    <tr mat-row
                        *matRowDef="let row; columns: ['sno','head','divName_En','district','blockname','letterNo','approver','work','tsDate','tsamt','tType','aadt','asAmt','tenderReference','acceptanceLetterRefNo','acceptLetterDT','totalAmountOfContract','work_id']">
                    </tr> -->


            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>S.No</th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>

            <ng-container matColumnDef="worK_ID">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.worK_ID }} </td>
            </ng-container>

            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter No</th>
              <td mat-cell *matCellDef="let element"> {{ element.letterNo }} </td>
            </ng-container>
            <ng-container matColumnDef="grantNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head No</th>
              <td mat-cell *matCellDef="let element">{{ element.grantNo}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element"> {{ element.head }} </td>
            </ng-container>

            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element"> {{ element.approver }} </td>
            </ng-container>

            <!-- <ng-container matColumnDef="type_name">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Type</th>
              <td mat-cell *matCellDef="let element"> {{ element.type_name }} </td>
            </ng-container> -->

            <ng-container matColumnDef="divName_En">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.divName_En }} </td>
            </ng-container>

            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district }} </td>
            </ng-container>

            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname }} </td>
            </ng-container>

            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element"> {{ element.work }} </td>
            </ng-container>

            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt }} </td>
            </ng-container>
            <ng-container matColumnDef="totalpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="totalunpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Unpaid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalunpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt }} </td>
            </ng-container>

            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate }} </td>
            </ng-container>

            <ng-container matColumnDef="aadt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aadt }} </td>
            </ng-container>

            <ng-container matColumnDef="lProgress">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress</th>
              <td mat-cell *matCellDef="let element"> {{ element.lProgress }} </td>
            </ng-container>

            <ng-container matColumnDef="progressDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.progressDT }} </td>
            </ng-container>

            <ng-container matColumnDef="remarks">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
              <td mat-cell *matCellDef="let element"> {{ element.remarks }} </td>
            </ng-container>

            <ng-container matColumnDef="groupName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Group</th>
              <td mat-cell *matCellDef="let element"> {{ element.groupName }} </td>
            </ng-container>

            <ng-container matColumnDef="dashName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Dashboard</th>
              <td mat-cell *matCellDef="let element"> {{ element.dashName }} </td>
            </ng-container>

            <ng-container matColumnDef="asPath">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Path</th>
              <td mat-cell *matCellDef="let element"> {{ element.asPath }} </td>
            </ng-container>

            <ng-container matColumnDef="asLetter">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter</th>
              <td mat-cell *matCellDef="let element"> {{ element.asLetter }} </td>
            </ng-container>

            <ng-container matColumnDef="asid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.asid }} </td>
            </ng-container>

            <ng-container matColumnDef="descri">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Description</th>
              <td mat-cell *matCellDef="let element"> {{ element.descri }} </td>
            </ng-container>

            <ng-container matColumnDef="fmrcode">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>FMR Code</th>
              <td mat-cell *matCellDef="let element"> {{ element.fmrcode }} </td>
            </ng-container>

            <ng-container matColumnDef="startdt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Start Date</th>
              <td mat-cell *matCellDef="let element">{{ element.startdt }} </td>
            </ng-container>
            <ng-container matColumnDef="enddt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>End Date</th>
              <td mat-cell *matCellDef="let element">{{ element.enddt }} </td>
            </ng-container>
            <ng-container matColumnDef="noofcalls">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NO. of Calls</th>
              <td mat-cell *matCellDef="let element">{{ element.noofcalls}} </td>
            </ng-container>
            <ng-container matColumnDef="tenderno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender NO.</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderno}} </td>
            </ng-container>
            <ng-container matColumnDef="eprocno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Eproc NO.</th>
              <td mat-cell *matCellDef="let element">{{ element.eprocno}} </td>
            </ng-container>
            <ng-container matColumnDef="covOpenedDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>COV Opened DT</th>
              <td mat-cell *matCellDef="let element">{{ element.covOpenedDT}} </td>
            </ng-container>
            <ng-container matColumnDef="topnedpricedt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Topned price DT</th>
              <td mat-cell *matCellDef="let element">{{ element.topnedpricedt}} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <!-- <button class="btn btn-light btn-sm btn-outline-secondary align-items-center" [ngClass]="[value == 'Active' ? 'btn-secondary' : 'btn-light']"  mat-button (click)="onButtonClick(element.asid,0)"> -->
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.worK_ID)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="[ 'sno', 'worK_ID', 'letterNo','grantNo', 'head', 'approver', 'divName_En',
                        'district', 'blockname', 'work', 'asAmt', 'totalpaid','totalunpaid','tsamt', 'tsDate', 'aadt',
                        'lProgress', 'progressDT', 'remarks', 'groupName', 'dashName', 'asPath',
                        'asLetter', 'asid', 'descri', 'fmrcode', 'startdt', 'enddt', 'noofcalls',
                        'tenderno', 'eprocno', 'covOpenedDT', 'topnedpricedt','action']">
            </tr>
            <tr mat-row *matRowDef="let row; columns: [ 'sno', 'worK_ID', 'letterNo','grantNo', 'head', 'approver','divName_En',
                        'district', 'blockname', 'work', 'asAmt','totalpaid','totalunpaid', 'tsamt', 'tsDate', 'aadt',
                        'lProgress', 'progressDT', 'remarks', 'groupName', 'dashName', 'asPath',
                        'asLetter', 'asid', 'descri', 'fmrcode', 'startdt', 'enddt', 'noofcalls',
                        'tenderno', 'eprocno', 'covOpenedDT', 'topnedpricedt','action']">
            </tr>

          </table>
          <mat-paginator #paginator2 [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>
  <!-- Tender in Process -->
  <ng-template class=" " #itemDetailsModal3 let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Progress Level:<span class="text-primary"> {{dashname}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{nosworks}}</span></h1>
        <!-- <h1>Tender In Process</h1> -->
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter"
              (keyup)="applyTextFilter_TenderInProcess($event)">
          </div>
          <div class="export-menu-container">
            <button type="button" class="btn border rounded btn-outline-secondary" mat-button
              [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'TenderinProcess', sheet: 'TenderinProcess', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="expor_TenderInProcess_PDFT()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSource3" #exporter="matTableExporter" matSort #sort3="matSort">

            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>S.No</th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.work_id }} </td>
            </ng-container>
            <ng-container matColumnDef="grantNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head No</th>
              <td mat-cell *matCellDef="let element">{{ element.grantNo}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element"> {{ element.head }} </td>
            </ng-container>

            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district }} </td>
            </ng-container>

            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname }} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter No</th>
              <td mat-cell *matCellDef="let element"> {{ element.letterNo }} </td>
            </ng-container>

            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element"> {{ element.work }} </td>
            </ng-container>
            <ng-container matColumnDef="tenderno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT No.</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderno}} </td>
            </ng-container>
            <ng-container matColumnDef="eprocno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>e-Proc NO.</th>
              <td mat-cell *matCellDef="let element">{{ element.eprocno}} </td>
            </ng-container>
            <ng-container matColumnDef="noofcalls">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>No. of Calls</th>
              <td mat-cell *matCellDef="let element">{{ element.noofcalls}} </td>
            </ng-container>
            <ng-container matColumnDef="aadt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aadt }} </td>
            </ng-container>
            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt }} </td>
            </ng-container>
            <ng-container matColumnDef="totalpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="totalunpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Unpaid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalunpaid}} </td>
            </ng-container>

            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate }} </td>
            </ng-container>
            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt }} </td>
            </ng-container>
            <ng-container matColumnDef="lProgress">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress</th>
              <td mat-cell *matCellDef="let element"> {{ element.lProgress }} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="progressDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.progressDT }} </td>
            </ng-container> -->

            <ng-container matColumnDef="startdt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Start DT</th>
              <td mat-cell *matCellDef="let element">{{ element.startdt }} </td>
            </ng-container>
            <ng-container matColumnDef="enddt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender End DT</th>
              <td mat-cell *matCellDef="let element">{{ element.enddt }} </td>
            </ng-container>


            <ng-container matColumnDef="covOpenedDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tech. Opened DT</th>
              <td mat-cell *matCellDef="let element">{{ element.covOpenedDT}} </td>
            </ng-container>
            <ng-container matColumnDef="topnedpricedt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Price Opned DT</th>
              <td mat-cell *matCellDef="let element">{{ element.topnedpricedt}} </td>
            </ng-container>
            <ng-container matColumnDef="divName_En">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.divName_En }} </td>
            </ng-container>
            <ng-container matColumnDef="fmrcode">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>FMR Code</th>
              <td mat-cell *matCellDef="let element"> {{ element.fmrcode }} </td>
            </ng-container>
            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element"> {{ element.approver }} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>

            <!-- <ng-container matColumnDef="type_name">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Type</th>
              <td mat-cell *matCellDef="let element"> {{ element.type_name }} </td>
            </ng-container>
            <ng-container matColumnDef="remarks">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
              <td mat-cell *matCellDef="let element"> {{ element.remarks }} </td>
            </ng-container>
            <ng-container matColumnDef="groupName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Group</th>
              <td mat-cell *matCellDef="let element"> {{ element.groupName }} </td>
            </ng-container>
  
            <ng-container matColumnDef="dashName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Dashboard</th>
              <td mat-cell *matCellDef="let element"> {{ element.dashName }} </td>
            </ng-container>
  
            <ng-container matColumnDef="asPath">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Path</th>
              <td mat-cell *matCellDef="let element"> {{ element.asPath }} </td>
            </ng-container>
            <ng-container matColumnDef="asid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.asid }} </td>
            </ng-container>
            <ng-container matColumnDef="descri">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Description</th>
              <td mat-cell *matCellDef="let element"> {{ element.descri }} </td>
            </ng-container>
            <ng-container matColumnDef="fmrcode">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>FMR Code</th>
              <td mat-cell *matCellDef="let element"> {{ element.fmrcode }} </td>
            </ng-container> -->

            <!-- 'sno','head','divName_En','district','blockname','letterNo','approver','work','aadt','asAmt','tsDate','tsamt','tType',
      'tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','cid','contractorNAme','mobNo','lProgress',
      'progressDT','expcompdt','delayreason','subengname',
      'aeName','work_id','asLetter','action']"> -->
            <tr mat-header-row *matHeaderRowDef="['sno','work_id','grantNo','head','district','blockname','letterNo',
            'work','tenderno', 'eprocno','noofcalls','aadt','asAmt','totalpaid','totalunpaid','tsDate','tsamt',
            'lProgress', 'startdt','enddt',
             'covOpenedDT','topnedpricedt','divName_En','fmrcode','approver','action']">
              <!-- <tr mat-header-row *matHeaderRowDef="[ 'sno', 'work_id', 'letterNo', 'head', 'approver', 'type_name', 'divName_En',
                      'district', 'blockname', 'work', 'asAmt', 'tsamt', 'tsDate', 'aadt',
                      'lProgress', 'progressDT', 'remarks', 'groupName', 'dashName', 'asPath',
                      'asLetter', 'asid', 'descri', 'fmrcode', 'startdt', 'enddt', 'noofcalls',
                      'tenderno', 'eprocno', 'covOpenedDT', 'topnedpricedt','action']"> -->
            </tr>
            <tr mat-row *matRowDef="let row; columns: ['sno','work_id','grantNo','head','district','blockname','letterNo',
            'work','tenderno', 'eprocno','noofcalls','aadt','asAmt','totalpaid','totalunpaid','tsDate','tsamt',
            'lProgress', 'startdt','enddt',
             'covOpenedDT','topnedpricedt','divName_En','fmrcode','approver','action']">
            </tr>
          </table>
          <mat-paginator #paginator3 [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>

  <!-- Handover Details -->
  <ng-template class=" " #itemDetailsModalHandover let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <!-- <h1>Handover Details</h1> -->
        <h1 class="text-primary-emphasis">Handover Details</h1>
        <h1 class="text-primary-emphasis">Selected Name :<span class="text-primary">{{name}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{totalWorks}}</span></h1>
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterHandover($event)">
          </div>
          <div class="export-menu-container">
            <button class="btn  btn-outline-secondary" mat-button [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'HandoverDetails', sheet: 'HandoverDetails', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDFHandover()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSourceHanover" #exporter="matTableExporter" matSort #sortHandover="matSort">

            <!-- Serial Number Column -->
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>S.NO</th>
              <td mat-cell *matCellDef="let element"> {{ element.sno}} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>LetterNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.letterNo }} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element"> {{ element.head }} </td>
            </ng-container>
            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AcceptLetterDT</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT }} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TotalAmountOfContract</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract }} </td>
            </ng-container>
            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district }} </td>
            </ng-container>
            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element"> {{ element.work }} </td>
            </ng-container>
            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>ContractorName</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme }} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.work_id }} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <!-- <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr> -->
            <!-- Header Row -->

            <tr mat-header-row
              *matHeaderRowDef="['sno','letterNo', 'head','acceptLetterDT','totalAmountOfContract','district','work','contractorNAme','work_id','action']">
            </tr>

            <!-- Data Rows -->
            <tr mat-row
              *matRowDef="let row; columns: ['sno','letterNo', 'head','acceptLetterDT','totalAmountOfContract','district','work','contractorNAme','work_id','action']">
            </tr>
          </table>
          <mat-paginator #paginatorHandover [pageSizeOptions]="[10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>
    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>

  <!-- Payment Due Details -->
  <ng-template class=" " #itemDetailsModalUnPaid let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1>Payment Due Details</h1>
        <h1>Selected Name: {{name}}</h1>
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="UNapplyTextFilter($event)">
          </div>
          <div class="export-menu-container">
            <button class="btn  btn-outline-secondary" mat-button [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'PaymentDueDetails', sheet: 'PaymentDueDetails', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="UNexportToPDF()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSourceUnPaid" #exporter="matTableExporter" matSort #sortUnPaid="matSort">

            <!-- Serial Number Column -->
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>S.NO</th>
              <td mat-cell *matCellDef="let element"> {{ element.sno}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element"> {{ element.head }} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter No</th>
              <td mat-cell *matCellDef="let element"> {{ element.letterNo }}/DT:{{ element.aaDate }} </td>
            </ng-container> -->
            <ng-container matColumnDef="division">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.division }} </td>
            </ng-container>
            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district }} </td>
            </ng-container>

            <ng-container matColumnDef="workname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element"> {{ element.workname}} </td>
            </ng-container>
            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Wrok Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
            </ng-container>
            <ng-container matColumnDef="totalamountofcontract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contract Value (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalamountofcontract}} </td>
            </ng-container>
            <ng-container matColumnDef="totalpaidtillinlac">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid Till(In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaidtillinlac}}</td>
            </ng-container>
            <ng-container matColumnDef="mesurementDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Measurement DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.mesurementDT}}</td>
            </ng-container>
            <ng-container matColumnDef="billno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Bill No.</th>
              <td mat-cell *matCellDef="let element"> {{ element.billno }}/DT:</td>
            </ng-container>
            <ng-container matColumnDef="billdate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Bill DT</th>
              <td mat-cell *matCellDef="let element">{{element.billdate}} </td>
            </ng-container>
            <ng-container matColumnDef="agrbillstatus">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Bill Type</th>
              <td mat-cell *matCellDef="let element"> {{ element.agrbillstatus}} </td>
            </ng-container>

            <!-- <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Ref. No</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/No:{{element.workorderRefNoGovt}} </td>
            </ng-container> -->
            <!-- <ng-container matColumnDef="aaamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.aaamt}} </td>
            </ng-container> -->

            <!-- <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container> -->
            <!-- <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}}/DT:{{ element.tsDate}} </td>
            </ng-container> -->

            <!-- <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction Rate </th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate }}/{{element.sanctionDetail}} </td>
            </ng-container> -->

            <ng-container matColumnDef="grossAmtNew">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Gross Amount Due(In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.grossAmtNew}} </td>
            </ng-container>
            <ng-container matColumnDef="dayssincemeasurement">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Days Since Measurement</th>
              <td mat-cell *matCellDef="let element"> {{ element.dayssincemeasurement}} </td>
            </ng-container>
            <ng-container matColumnDef="engName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Eng.</th>
              <td mat-cell *matCellDef="let element"> {{ element.engName}}</td>
            </ng-container>
            <ng-container matColumnDef="designation">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Pending With</th>
              <td mat-cell *matCellDef="let element"> {{ element.designation}} </td>
            </ng-container>
            <ng-container matColumnDef="worK_ID">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.worK_ID }} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.worK_ID)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <!-- <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr> -->
            <!-- Header Row -->
            <tr mat-header-row
              *matHeaderRowDef="['sno', 'head','district','division','workname','wrokOrderDT','billno','agrbillstatus','totalamountofcontract','grossAmtNew','totalpaidtillinlac','dayssincemeasurement','mesurementDT','engName','designation','worK_ID','action']">
            </tr>

            <!-- Data Rows -->
            <tr mat-row
              *matRowDef="let row; columns: ['sno', 'head','district','division','workname','wrokOrderDT','billno','agrbillstatus','totalamountofcontract','grossAmtNew','totalpaidtillinlac','dayssincemeasurement','mesurementDT','engName','designation','worK_ID','action']">
            </tr>
          </table>
          <mat-paginator #paginatorUnPaid [pageSizeOptions]="[10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer mt-2 p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
    <!-- <div class="d-grid gap-2 col-12 mx-auto  m-2">
      <button mat-button mat-dialog-close  type="button" class="btn btn-info btn-lg" >
        <mat-icon role="img" mat-card-avatar 
                  class="mat-icon notranslate mat-card-avatar material-icons mat-icon-no-color" 
                  aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div> -->
  </ng-template>

  <!--Payment Details  -->
  <ng-template class=" " #itemDetailsModalPaid let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1>Payment Details</h1>
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterPaid($event)">
          </div>
          <div class="export-menu-container">
            <button class="btn  btn-outline-secondary" mat-button [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'PaymentDetails', sheet: 'PaymentDetails', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDFPaid()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSourcePaid" #exporter="matTableExporter" matSort #sortPaid="matSort">

            <!-- Serial Number Column -->
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>S.NO</th>
              <td mat-cell *matCellDef="let element"> {{ element.sno}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element"> {{ element.head }} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter No</th>
              <td mat-cell *matCellDef="let element"> {{ element.letterNo }}/DT:{{ element.aaDate }} </td>
            </ng-container> -->
            <ng-container matColumnDef="division">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
              <td mat-cell *matCellDef="let element"> {{ element.division }} </td>
            </ng-container>
            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district }} </td>
            </ng-container>

            <ng-container matColumnDef="workname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element"> {{ element.workname}} </td>
            </ng-container>
            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
            </ng-container>
            <ng-container matColumnDef="billno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Bill No.</th>
              <td mat-cell *matCellDef="let element"> {{ element.billno }}/DT:{{element.billdate}} </td>
            </ng-container>
            <ng-container matColumnDef="agrbillstatus">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AGR Bill Status</th>
              <td mat-cell *matCellDef="let element"> {{ element.agrbillstatus }} </td>
            </ng-container>

            <!-- <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Ref. No</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/No:{{element.workorderRefNoGovt}} </td>
            </ng-container> -->
            <!-- <ng-container matColumnDef="aaamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.aaamt}} </td>
            </ng-container> -->

            <!-- <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container> -->
            <!-- <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}}/DT:{{ element.tsDate}} </td>
            </ng-container> -->

            <!-- <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction Rate </th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate }}/{{element.sanctionDetail}} </td>
            </ng-container> -->
            <ng-container matColumnDef="totalamountofcontract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contract Value (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalamountofcontract}} </td>
            </ng-container>
            <ng-container matColumnDef="grosspaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Gross Paid Value (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.grosspaid}} </td>
            </ng-container>

            <ng-container matColumnDef="totalpaidtillinlac">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid Till(In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaidtillinlac}}</td>
            </ng-container>
            <ng-container matColumnDef="chequeDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Cheque DT.</th>
              <td mat-cell *matCellDef="let element"> {{ element.chequeDT}} </td>
            </ng-container>
            <ng-container matColumnDef="mesurementDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Measurement DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.mesurementDT}}/DAY:{{element.dayssincemeasurement}}
              </td>
            </ng-container>
            <ng-container matColumnDef="worK_ID">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.worK_ID }} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.worK_ID)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <!-- <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr> -->
            <!-- Header Row -->
            <tr mat-header-row
              *matHeaderRowDef="['sno', 'head','division','district','workname','wrokOrderDT','billno','agrbillstatus','totalamountofcontract','grosspaid','totalpaidtillinlac','chequeDT','mesurementDT','worK_ID','action']">
            </tr>

            <!-- Data Rows -->
            <tr mat-row
              *matRowDef="let row; columns: ['sno', 'head','division','district','workname','wrokOrderDT','billno','agrbillstatus','totalamountofcontract','grosspaid','totalpaidtillinlac','chequeDT','mesurementDT','worK_ID','action']">
            </tr>
          </table>
          <mat-paginator #paginatorPaid [pageSizeOptions]="[10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>

  <!-- Live Tender -->
  <ng-template class=" " #itemDetailsModalLT let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Live Tender</h1>
        <h1 class="text-primary-emphasis">Selected Name:<span class="text-primary"> {{name}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{nosWorks}}</span></h1>
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>

    </div>
    <div class="mb-3" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterLIT($event)">
          </div>
          <div class="export-menu-container">
            <button class="btn  btn-outline-secondary" mat-button [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'TenderDetails', sheet: 'TenderDetails', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDFLIT()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSourceLiveTender" #exporter="matTableExporter" matSort #sortLivet="matSort">

            <!-- Serial Number Column -->
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>S.NO</th>
              <td mat-cell *matCellDef="let element"> {{ element.sno}} </td>
            </ng-container>
            <ng-container matColumnDef="letterno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter No</th>
              <td mat-cell *matCellDef="let element"> {{ element.letterno }} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element"> {{ element.head }} </td>
            </ng-container>
            <ng-container matColumnDef="aA_RAA_Date">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aA_RAA_Date }} </td>
            </ng-container>
            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt }} </td>
            </ng-container>
            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district }} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.work_id }} </td>
            </ng-container>
            <ng-container matColumnDef="workname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Name</th>
              <td mat-cell *matCellDef="let element"> {{ element.workname }} </td>
            </ng-container>
            <ng-container matColumnDef="startdt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Start Dt</th>
              <td mat-cell *matCellDef="let element"> {{ element.startdt }} </td>
            </ng-container>
            <ng-container matColumnDef="enddt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>End Dt</th>
              <td mat-cell *matCellDef="let element"> {{ element.enddt }} </td>
            </ng-container>
            <ng-container matColumnDef="noofcalls">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NO of Calls</th>
              <td mat-cell *matCellDef="let element"> {{ element.noofcalls }} </td>
            </ng-container>
            <ng-container matColumnDef="tenderno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT NO</th>
              <td mat-cell *matCellDef="let element"> {{ element.tenderno }} </td>
            </ng-container>
            <ng-container matColumnDef="eprocno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>e-Procno</th>
              <td mat-cell *matCellDef="let element"> {{ element.eprocno }} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <!-- <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr> -->
            <!-- Header Row -->
            <tr mat-header-row
              *matHeaderRowDef="['sno','letterno','head','aA_RAA_Date','asAmt','district','work_id','workname','startdt','enddt','noofcalls','eprocno','tenderno','action']">
            </tr>

            <!-- Data Rows -->
            <tr mat-row
              *matRowDef="let row; columns: ['sno','letterno','head','aA_RAA_Date','asAmt','district','work_id','workname','startdt','enddt','noofcalls','eprocno','tenderno','action'];">
            </tr>
          </table>
          <mat-paginator #paginatorLivet [pageSizeOptions]="[10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer mt-2 p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>

  <!-- TechnicalEvaluation -->
  <ng-template class=" " #itemDetailsModalTE let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <!-- <h1>Tender Evaluation Details</h1> -->
        <h1 class="text-primary-emphasis">{{name}}</h1>
        <h1 class="text-primary-emphasis">Selected Name:<span class="text-primary"> {{selectedName}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{nosWorks}}</span></h1>
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterTE($event)">
          </div>
          <div class="export-menu-container">
            <button class="btn  btn-outline-secondary" mat-button [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'TechnicalEvaluation', sheet: 'TechnicalEvaluation', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDFTE()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSourceTenderE" #exporter="matTableExporter" matSort #sortTenderE="matSort">

            <!-- Serial Number Column -->
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>S.NO</th>
              <td mat-cell *matCellDef="let element"> {{ element.sno}} </td>
            </ng-container>
            <ng-container matColumnDef="letterno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter No</th>
              <td mat-cell *matCellDef="let element"> {{ element.letterno }} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element"> {{ element.head }} </td>
            </ng-container>
            <ng-container matColumnDef="aA_RAA_Date">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aA_RAA_Date }} </td>
            </ng-container>
            <ng-container matColumnDef="asAmt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount</th>
              <td mat-cell *matCellDef="let element"> {{ element.asAmt }} </td>
            </ng-container>
            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district }} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.work_id }} </td>
            </ng-container>
            <ng-container matColumnDef="workname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Name</th>
              <td mat-cell *matCellDef="let element"> {{ element.workname }} </td>
            </ng-container>
            <ng-container matColumnDef="startdt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Start Dt</th>
              <td mat-cell *matCellDef="let element"> {{ element.startdt }} </td>
            </ng-container>
            <ng-container matColumnDef="enddt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>End Dt</th>
              <td mat-cell *matCellDef="let element"> {{ element.enddt }} </td>
            </ng-container>
            <ng-container matColumnDef="noofcalls">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NO of Calls</th>
              <td mat-cell *matCellDef="let element"> {{ element.noofcalls }} </td>
            </ng-container>
            <ng-container matColumnDef="tenderno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT NO</th>
              <td mat-cell *matCellDef="let element"> {{ element.tenderno }} </td>
            </ng-container>
            <ng-container matColumnDef="tOpnedDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Cover A Opened DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.tOpnedDT}} </td>
            </ng-container>
            <ng-container matColumnDef="topnedbdt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Cover B Opened DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.topnedbdt }} </td>
            </ng-container>
            <ng-container matColumnDef="daysSinceOpen">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Days Since Cov A/B Opned</th>
              <td mat-cell *matCellDef="let element"> {{ element.daysSinceOpen }} </td>
            </ng-container>
            <ng-container matColumnDef="eprocno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>e-Procno</th>
              <td mat-cell *matCellDef="let element"> {{ element.eprocno }} </td>
            </ng-container>
            <!-- <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr> -->
            <!-- Header Row -->
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <tr mat-header-row
              *matHeaderRowDef="['sno','letterno','head','aA_RAA_Date','asAmt','district','work_id','workname','startdt','enddt','noofcalls','eprocno','tenderno','tOpnedDT','topnedbdt','daysSinceOpen','action']">
            </tr>
            <!-- TOpnedDT,topnedbdt,daysSinceOpen -->
            <!-- Data Rows -->
            <tr mat-row
              *matRowDef="let row; columns: ['sno','letterno','head','aA_RAA_Date','asAmt','district','work_id','workname','startdt','enddt','noofcalls','eprocno','tenderno','tOpnedDT','topnedbdt','daysSinceOpen','action'];">
            </tr>
          </table>
          <mat-paginator #paginatorTenderE [pageSizeOptions]="[10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer mt-1 p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>

  <!-- Work Order Pending -->
  <ng-template class=" " #itemDetailsModalWOP let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Work Order Pending</h1>
        <h1 class="text-primary-emphasis">Selected Name :<span class="text-primary">{{name}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{noofWorksGreater7Days}}</span></h1>
        <!-- <h3 class="bold text-Dark"> {{name}}</h3>Pending more than 7 Days: {{noofWorksGreater7Days}} -->
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterWOP($event)">
          </div>
          <div class="export-menu-container">
            <button class="btn  btn-outline-secondary" mat-button [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'WorkOrderPending', sheet: 'WorkOrderPending', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDFWOP()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSourceWorkP" #exporter="matTableExporter" matSort #sortWOP="matSort">

            <!-- Serial Number Column -->
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>S.NO</th>
              <td mat-cell *matCellDef="let element"> {{ element.sno}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element"> {{ element.head }} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter No</th>
              <td mat-cell *matCellDef="let element"> {{ element.letterNo }}/DT:{{ element.aaDate }} </td>
            </ng-container>
            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district }} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname }} </td>
            </ng-container>
            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element"> {{ element.work }} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="aaDate">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
            <td mat-cell *matCellDef="let element"> {{ element.aaDate }} </td>
          </ng-container> -->
            <ng-container matColumnDef="aaamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.aaamt}} </td>
            </ng-container>

            <!-- <ng-container matColumnDef="tsDate">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
            <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
          </ng-container> -->
            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}}/DT:{{ element.tsDate}} </td>
            </ng-container>

            <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction Rate </th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate }}/{{element.sanctionDetail}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contract Value (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract }} </td>
            </ng-container>

            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme }}/{{ element.mobNo}} </td>
            </ng-container>
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Ref.</th>
              <td mat-cell *matCellDef="let element"> {{ element.tenderReference }} </td>
            </ng-container>
            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accepted Info</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT }}/NO:{{element.acceptanceLetterRefNo}}
              </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.work_id }} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <!-- <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr> -->
            <!-- Header Row -->
            <tr mat-header-row
              *matHeaderRowDef="['sno', 'head','district','blockname','work','letterNo','tsamt','sanctionRate','totalAmountOfContract','tenderReference','acceptLetterDT','contractorNAme','work_id','action']">
            </tr>

            <!-- Data Rows -->
            <tr mat-row
              *matRowDef="let row; columns: ['sno', 'head','district','blockname','work','letterNo','tsamt','sanctionRate','totalAmountOfContract','tenderReference','acceptLetterDT','contractorNAme','work_id','action']">
            </tr>
          </table>
          <mat-paginator #paginatorWOP [pageSizeOptions]="[10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer mt-1 p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>

  <!-- Land Issued  -->
  <ng-template class=" " #itemDetailsModalLI let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Land Issue Details</h1>
        <h1 class="text-primary-emphasis">Selected Name :<span class="text-primary">{{name}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{totalWorks}}</span></h1>
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterLI($event)">
          </div>
          <div class="export-menu-container">
            <button class="btn  btn-outline-secondary" mat-button [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'LandIssueDetails', sheet: 'LandIssueDetails', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDFLI()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSourceLI" #exporter="matTableExporter" matSort #sortLI="matSort">
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
              <td mat-cell *matCellDef="let element"> {{ element.sno }} </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element">{{ element.work_id}}</td>
            </ng-container>
            <ng-container matColumnDef="grantNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head No</th>
              <td mat-cell *matCellDef="let element">{{ element.grantNo}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element">{{ element.head}} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="divName_En">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
            <td mat-cell *matCellDef="let element"> {{ element.divName_En}} </td>
          </ng-container> -->

            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district}} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname}} </td>
            </ng-container>

            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element">{{ element.work}} </td>
            </ng-container>



            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT}} </td>
            </ng-container>
            <ng-container matColumnDef="timeAllowed">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Time Allowed</th>
              <td mat-cell *matCellDef="let element"> {{ element.timeAllowed}} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="dueDTTimePerAdded">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Completion</th>
            <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded}} </td>
          </ng-container> -->
            <ng-container matColumnDef="lProgress">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress Level</th>
              <td mat-cell *matCellDef="let element"> {{ element.lProgress}} </td>
            </ng-container>
            <ng-container matColumnDef="pdate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.pdate}} </td>
            </ng-container>

            <ng-container matColumnDef="delayReason" style="width: 50%;">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Delay Reason</th>
              <td mat-cell *matCellDef="let element"> {{ element.delayReason}} </td>
            </ng-container>
            <ng-container matColumnDef="pRemarks">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
              <td mat-cell *matCellDef="let element"> {{ element.pRemarks}}/{{ element.remarks}} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="expcompdt">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Exp. Comp DT</th>
      <td mat-cell *matCellDef="let element"> {{ element.expcompdt}} </td>
  </ng-container> -->
            <!-- <ng-container matColumnDef="Remarks">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Remarks</th>
          <td mat-cell *matCellDef="let element"> {{ element.Remarks}} </td>
      </ng-container>  -->

            <ng-container matColumnDef="subengname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sub Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.subengname}} </td>
            </ng-container>
            <ng-container matColumnDef="aeName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Asst.Eng</th>
              <td mat-cell *matCellDef="let element"> {{ element.aeName}} </td>
            </ng-container>
            <ng-container matColumnDef="aaDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.aaDate}} </td>
            </ng-container>

            <ng-container matColumnDef="aaamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.aaamt}} </td>
            </ng-container>
            <ng-container matColumnDef="tsDate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
            </ng-container>

            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Amount(in Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}} </td>
            </ng-container>
            <!-- <ng-container matColumnDef="tType">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Type</th>
            <td mat-cell *matCellDef="let element"> {{ element.tType}} </td>
          </ng-container> -->
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT Reference</th>
              <td mat-cell *matCellDef="let element">{{ element.tenderReference}} </td>
            </ng-container>
            <ng-container matColumnDef="dateOfIssueNIT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>NIT/Sanction DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.dateOfIssueNIT}}/ {{ element.dateOfSanction}} </td>
            </ng-container>
            <ng-container matColumnDef="acceptanceLetterRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Acceptance Letter RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptanceLetterRefNo}} </td>
            </ng-container>
            <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work Order RefNo</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/ {{ element.workorderRefNoGovt}}</td>
            </ng-container>
            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accepted DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Rate%</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate}} </td>
            </ng-container>
            <ng-container matColumnDef="sanctionDetail">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction</th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionDetail}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contract Value(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract}} </td>
            </ng-container>
            <ng-container matColumnDef="totalpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Paid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="totalunpaid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Unpaid(In Lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalunpaid}} </td>
            </ng-container>
            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme}} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter NO</th>
              <td mat-cell *matCellDef="let element">{{ element.letterNo}} </td>
            </ng-container>
            <ng-container matColumnDef="approver">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver</th>
              <td mat-cell *matCellDef="let element">{{ element.approver}} </td>
            </ng-container>

            <ng-container matColumnDef="cid">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor ID/Class</th>
              <td mat-cell *matCellDef="let element"> {{ element.cid}}/{{ element.regType}} </td>
            </ng-container>

            <ng-container matColumnDef="mobNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor Mobile No</th>
              <td mat-cell *matCellDef="let element"> {{ element.mobNo}} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <tr mat-header-row
              *matHeaderRowDef="['sno','work_id','grantNo','head','district','blockname','work','wrokOrderDT','timeAllowed','lProgress','pdate','delayReason','pRemarks','subengname','aeName','aaDate','aaamt','tsDate','tsamt','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','contractorNAme','letterNo','approver','cid','mobNo','action']">
            </tr>
            <tr mat-row
              *matRowDef="let row; columns: ['sno','work_id','grantNo','head','district','blockname','work','wrokOrderDT','timeAllowed','lProgress','pdate','delayReason','pRemarks','subengname','aeName','aaDate','aaamt','tsDate','tsamt','tenderReference','dateOfIssueNIT','acceptanceLetterRefNo','agreementRefNo','acceptLetterDT','sanctionRate','sanctionDetail','totalAmountOfContract','totalpaid','totalunpaid','contractorNAme','letterNo','approver','cid','mobNo','action']">
            </tr>
          </table>
          <mat-paginator #paginatorLI [pageSizeOptions]="[5, 10,15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer mt-1 p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>

  <!--Land Issued Gen  -->
  <ng-template class=" " #itemDetailsModalWOGD let-modal>
    <div class="row align-items-center p-2 m-2 ">
      <div class="col-lg-6 col-md-8">
        <h1 class="text-primary-emphasis">Work Order Issued</h1>
        <h1 class="text-primary-emphasis">Selected Name :<span class="text-primary">{{name}}</span></h1>
        <h1 class="text-primary-emphasis">No. of Works: <span class="text-primary">{{totalWorks}}</span></h1>
      </div>
      <div class="col-lg-6 col-md-4 text-end">
        <button type="button" class="btn-close" mat-button mat-dialog-close aria-label="Close"></button>
      </div>
    </div>
    <div class="" mat-dialog-content>
      <div class="row card shadow card-body ">
        <div class="d-flex justify-content-between align-items-center mb-0">
          <div class="filter-field flex-grow-1">
            <input type="text" class="form-control" placeholder="Filter" (keyup)="applyTextFilterWGD($event)">
          </div>
          <div class="export-menu-container">
            <button class="btn  btn-outline-secondary" mat-button [matMenuTriggerFor]="exportMenu">Export</button>
            <mat-menu #exportMenu="matMenu">
              <button mat-menu-item
                (click)="exporter.exportTable('xlsx', { fileName: 'WorkOrderIssued', sheet: 'WorkOrderIssued', Props: { Author: 'cgmsc' }})">Excel</button>
              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
              <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
              <button mat-menu-item (click)="exportToPDFWGD()">PDF</button>
            </mat-menu>
          </div>
        </div>

        <div class="table-responsive ">
          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
            [dataSource]="dataSourceWOGD" #exporter="matTableExporter" matSort #sortWGD="matSort">

            <!-- Serial Number Column -->
            <ng-container matColumnDef="sno">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>S.NO</th>
              <td mat-cell *matCellDef="let element"> {{ element.sno}} </td>
            </ng-container>
            <ng-container matColumnDef="head">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Head</th>
              <td mat-cell *matCellDef="let element"> {{ element.head }} </td>
            </ng-container>
            <ng-container matColumnDef="letterNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS Letter No</th>
              <td mat-cell *matCellDef="let element"> {{ element.letterNo }}/DT:{{ element.aaDate }} </td>
            </ng-container>
            <ng-container matColumnDef="district">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>District</th>
              <td mat-cell *matCellDef="let element"> {{ element.district }} </td>
            </ng-container>
            <ng-container matColumnDef="blockname">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Block</th>
              <td mat-cell *matCellDef="let element"> {{ element.blockname }} </td>
            </ng-container>
            <ng-container matColumnDef="work">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work</th>
              <td mat-cell *matCellDef="let element"> {{ element.work }} </td>
            </ng-container>
            <ng-container matColumnDef="wrokOrderDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Wrok Order DT</th>
              <td mat-cell *matCellDef="let element"> {{ element.wrokOrderDT }} </td>
            </ng-container>
            <ng-container matColumnDef="timeAllowed">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Time (month)</th>
              <td mat-cell *matCellDef="let element"> {{ element.timeAllowed }} </td>
            </ng-container>
            <ng-container matColumnDef="dueDTTimePerAdded">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Due DT Completion</th>
              <td mat-cell *matCellDef="let element"> {{ element.dueDTTimePerAdded }} </td>
            </ng-container>
            <ng-container matColumnDef="agreementRefNo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Ref. No</th>
              <td mat-cell *matCellDef="let element"> {{ element.agreementRefNo}}/No:{{element.workorderRefNoGovt}}
              </td>
            </ng-container>
            <ng-container matColumnDef="aaamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>AS (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.aaamt}} </td>
            </ng-container>

            <!-- <ng-container matColumnDef="tsDate">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>TS Date</th>
            <td mat-cell *matCellDef="let element"> {{ element.tsDate}} </td>
          </ng-container> -->
            <ng-container matColumnDef="tsamt">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>TS (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.tsamt}}/DT:{{ element.tsDate}} </td>
            </ng-container>

            <ng-container matColumnDef="sanctionRate">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Sanction Rate </th>
              <td mat-cell *matCellDef="let element"> {{ element.sanctionRate }}/{{element.sanctionDetail}} </td>
            </ng-container>
            <ng-container matColumnDef="totalAmountOfContract">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contract Value (In lacs)</th>
              <td mat-cell *matCellDef="let element"> {{ element.totalAmountOfContract }} </td>
            </ng-container>

            <ng-container matColumnDef="contractorNAme">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Contractor</th>
              <td mat-cell *matCellDef="let element"> {{ element.contractorNAme }}/{{ element.mobNo}} </td>
            </ng-container>
            <ng-container matColumnDef="tenderReference">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Tender Ref.</th>
              <td mat-cell *matCellDef="let element"> {{ element.tenderReference }} </td>
            </ng-container>
            <ng-container matColumnDef="acceptLetterDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Accepted Info</th>
              <td mat-cell *matCellDef="let element"> {{ element.acceptLetterDT }}/NO:{{element.acceptanceLetterRefNo}}
              </td>
            </ng-container>
            <ng-container matColumnDef="work_id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Work ID</th>
              <td mat-cell *matCellDef="let element"> {{ element.work_id }} </td>
            </ng-container>
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef>Download AS</th>
              <td mat-cell *matCellDef="let element">
                <span class="d-flex  flex-row-reverse p-2 ">
                  <button class="btn btn-light btn-sm btn-outline-secondary align-items-center border rounded"
                    mat-button (click)="onButtonClick2(0,element.work_id)">
                    <i class="bi bi-file-earmark-pdf me-0 bg-danger"></i>
                  </button>
                </span>
              </td>
            </ng-container>
            <!-- <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr> -->
            <!-- Header Row -->
            <tr mat-header-row
              *matHeaderRowDef="['sno', 'head','district','blockname','work','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','letterNo','tsamt','sanctionRate','totalAmountOfContract','tenderReference','acceptLetterDT','contractorNAme','work_id','action']">
            </tr>

            <!-- Data Rows -->
            <tr mat-row
              *matRowDef="let row; columns: ['sno', 'head','district','blockname','work','wrokOrderDT','timeAllowed','dueDTTimePerAdded','agreementRefNo','letterNo','tsamt','sanctionRate','totalAmountOfContract','tenderReference','acceptLetterDT','contractorNAme','work_id','action'];">
            </tr>
          </table>
          <mat-paginator #paginatorWGD [pageSizeOptions]="[10, 15, 30]" showFirstLastButtons></mat-paginator>
        </div>
      </div>


    </div>
    <div class="d-grid gap-2 col-12 mx-auto footer mt-1 p-2">
      <button mat-button mat-dialog-close type="button" class="btn btn-info btn-lg">
        <!-- mat-card-avatar  mat-card-avatar -->
        <mat-icon role="img" class="mat-icon notranslate  material-icons mat-icon-no-color" aria-hidden="true">
          exit_to_app
        </mat-icon>
      </button>
    </div>
  </ng-template>
